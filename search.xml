<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>SAGEA卫星重力数据处理：产品数据读取（编辑中）</title>
      <link href="/2025/03/10/SAGEA(2)_%E4%BA%A7%E5%93%81%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96/"/>
      <url>/2025/03/10/SAGEA(2)_%E4%BA%A7%E5%93%81%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96/</url>
      
        <content type="html"><![CDATA[<p>GRACE(-FO)二级重力产品以球谐系数形式给出了地球重力场异常在不同频段的分布情况，其后续使用以及科学分析等仍然需要进一步处理（如物理量分离、滤波去噪等）。SAGEA(Satellite Gravity Error Assessment)项目基于Python，提供了相应的数据下载、数据处理和误差分析等功能，项目开源地址为<a href="https://github.com/NCSGgroup/SaGEA">https://github.com/NCSGgroup/SaGEA</a>。本系列作为使用手册，希望可以帮助你更好地使用该工具，如果你在使用过程中有任何问题，欢迎与我讨论（<a href="mailto:liushuhao@hust.edu.cn">liushuhao@hust.edu.cn</a>）。本文将介绍如何使用SAGEA读取数据，并简单介绍一些初步的应用场景。</p><span id="more"></span><p>按照项目中README.md的指引安装后，路径<code>pysrc/auxiliary/read_file/</code>下的源文件将提供读取文件的功能，包括读取各类球谐产品（如GRACELevel-2 时变重力场产品）、Shpfile地形文件等。</p><h2 id="球谐产品读取">球谐产品读取</h2><p>用户可通过<code>pysrc/auxiliary/read_file/LoadL2SH.py</code>中的<code>load_SHC</code>函数来读取球谐产品，得到类<code>SHC</code>的实例（后续介绍），其具体使用如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pysrc.auxiliary.load_file.LoadL2SH <span class="keyword">import</span> load_SHC</span><br><span class="line"></span><br><span class="line">shc = load_SHC(*filepath, key: <span class="built_in">str</span>, lmax: <span class="built_in">int</span>, read_rows=<span class="literal">None</span>, get_dates=<span class="literal">False</span>, begin_date=<span class="literal">None</span>, end_date=<span class="literal">None</span>, dates_excluded=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">shc, dates_begin, dates_end = load_SHC(*filepath, key: <span class="built_in">str</span>, lmax: <span class="built_in">int</span>, read_rows=<span class="literal">None</span>, get_dates=<span class="literal">True</span>, begin_date=<span class="literal">None</span>, end_date=<span class="literal">None</span>, dates_excluded=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><blockquote><p>这里，参数<code>*filepath</code>,<code>key</code>和<code>lmax</code>是必须的，分别代表要读取文件的路径、识别符和最大阶次。</p><p><strong><code>filepath</code></strong>这里可以传一个和多个路径（<code>str</code> 或<code>pathlib.Path</code>实例对象）。当只有一个路径被传入时，若该路径指向一个文件，则读取该文件；若该路径指向一个文件夹，则读取该文件夹下（包括子文件夹下）的所有文件。同时，如果多个路径被传入，则按照上述规则读取每一个路径。</p><p><strong><code>key</code></strong>以<code>str</code>类型给出，规定了文件的哪些行需要被作为数据读取。如一些文件的数据部分以字符串<code>gfc</code>或<code>GRCOF2</code>开头，如：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">GRCOF2    0    0 0.100000000000E+01 0.000000000000E+00 0.0000E+00 0.0000E+00 20020405.0000 20020501.0000 nnnn</span><br><span class="line">GRCOF2    1    0 0.000000000000E+00 0.000000000000E+00 0.0000E+00 0.0000E+00 20020405.0000 20020501.0000 nnnn</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>或</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">gfc     0    0  1.000000000000e+00  0.000000000000e+00  0.000000000000e+00  0.000000000000e+00</span><br><span class="line">gfc     1    0  0.000000000000e+00  0.000000000000e+00  0.000000000000e+00  0.000000000000e+00</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>也有一些文件没有标识符，此时用户传入一个空字符串<code>key=""</code>即可。</p><p><strong><code>lmax</code></strong>是需要读取的最大阶次，以<code>int</code>类型给出，当然不能超过文件本身给的最大阶次，这没什么过多需要解释的。</p><p>另外还有一些参数，其本身已包含缺省值，用户可根据具体使用来修改。</p><p><strong>read_rows</strong>以可迭代对象传入，表示哪四列（从1开始索引）需要被分别读取为阶索引(l)、次索引 (m)、cos系数 (Clm)和sin系数(Slm)。一般情况下，如果<code>key</code>不为空字符，则默认<code>read_rows=(2,3,4,5)</code>，否则，默认<code>read_rows=(1,2,3,4)</code>。</p><p><strong><code>get_dates</code></strong>以布尔值传入，默认为<code>False</code>。如果<code>get_dates is False</code>，则返回值为一个值，即<code>SHC</code>的实例；而当<code>get_dates is True</code>时，函数将额外从读取路径的文件名中匹配该文件所对应的开始、结束日期，并且返回值为三个元素构成的元组，按顺序为<code>SHC</code>的实例、开始日期（<code>datetime.date</code>实例）构成的列表和结束日期（<code>datetime.date</code>实例）构成的列表。需要注意的是，如果需要读取日期，读取路径的文件名中必须包含相应的字段以匹配，并且支持的字段有这样几类格式：<code>yyyymmdd-yyyymmdd</code>,<code>yyyy-mm-dd-yyyy-mm-dd</code>,<code>yyyyddd-yyyyddd</code>以及<code>yyyy-mm</code>，对于前三种格式，前后的日期分别对应开始日期和结束日期，而对于第四种近定位到月的格式，返回结果中的开始日期均为当月的第一天，结束日期则均为当月的最后一天。</p><p><strong><code>begin_date</code>, <code>end_date</code> 和<code>dates_excluded</code></strong>分别以<code>datetime.date</code>实例、<code>datetime.date</code>实例，以及以<code>datetime.date</code>实例构成的列表的形式给出，代表需要读取的起止时间，以及这之间不需要读取的月份（即仅匹配到月）。注意这三个参数仅在参数<code>filepath</code>为一个指向文件夹的路径时生效。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> SAGEA使用手册 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 卫星重力数据 </tag>
            
            <tag> GRACE </tag>
            
            <tag> 球谐产品 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SAGEA卫星重力数据处理：数据类型SHC介绍</title>
      <link href="/2025/03/05/SAGEA(1_1)_%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8BSHC/"/>
      <url>/2025/03/05/SAGEA(1_1)_%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8BSHC/</url>
      
        <content type="html"><![CDATA[<p>GRACE(-FO)二级重力产品以球谐系数形式给出了地球重力场异常在不同频段的分布情况，其后续使用以及科学分析等仍然需要进一步处理（如物理量分离、滤波去噪等）。SAGEA(Satellite Gravity Error Assessment)项目基于Python，提供了相应的数据下载、数据处理和误差分析等功能，项目开源地址为<a href="https://github.com/NCSGgroup/SaGEA">https://github.com/NCSGgroup/SaGEA</a>。本系列作为使用手册，希望可以帮助你更好地使用该工具，如果你在使用过程中有任何问题，欢迎与我讨论（<a href="mailto:liushuhao@hust.edu.cn">liushuhao@hust.edu.cn</a>）。本文将介绍SAGEA中的数据类型<code>SHC</code>（SphericalHarmonic Coefficient）和<code>GRID</code> (Griddeddata)，并对它们的基本用法作简单介绍。</p><span id="more"></span><p>按照项目中README.md的指引安装后，路径<code>pysrc/auxiliary/data_class/</code>下的源文件<code>SHC.py</code>和<code>GRID.py</code>将提供对该工具包核心数据类型的定义。本篇文章主要介绍它们的结构和基本用法。</p><h1 id="球谐系数shc">球谐系数SHC</h1><h2 id="属性和生成">属性和生成</h2><p><code>SHC</code>被实例化后，其核心属性<code>SHC().value</code>以一个<code>numpy.ndarray</code>二维数组给出了一组或多组球谐系数，其中第一个维度是数据的组数，第二个维度则是对该组球谐系数的有序排列，具体为</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>shc = SHC().value</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>shc</span><br><span class="line"></span><br><span class="line">[[c1[<span class="number">0</span>,<span class="number">0</span>], s1[<span class="number">1</span>,<span class="number">1</span>], c1[<span class="number">1</span>,<span class="number">0</span>], c1[<span class="number">1</span>,<span class="number">1</span>], s1[<span class="number">2</span>,<span class="number">2</span>], s1[<span class="number">2</span>,<span class="number">1</span>], c1[<span class="number">2</span>,<span class="number">0</span>], c1[<span class="number">2</span>,<span class="number">1</span>], c1[<span class="number">2</span>,<span class="number">2</span>], s1[<span class="number">3</span>,<span class="number">3</span>] ...],</span><br><span class="line"> [c2[<span class="number">0</span>,<span class="number">0</span>], s2[<span class="number">1</span>,<span class="number">1</span>], c2[<span class="number">1</span>,<span class="number">0</span>], c2[<span class="number">1</span>,<span class="number">1</span>], s2[<span class="number">2</span>,<span class="number">2</span>], s2[<span class="number">2</span>,<span class="number">1</span>], c2[<span class="number">2</span>,<span class="number">0</span>], c2[<span class="number">2</span>,<span class="number">1</span>], c2[<span class="number">2</span>,<span class="number">2</span>], s2[<span class="number">3</span>,<span class="number">3</span>] ...],</span><br><span class="line"> [                                        ...                                         ]]</span><br></pre></td></tr></table></figure><p>注意，即使被存储的数据仅含有一组时，其属性<code>.value</code>仍然为一个二维数组，此时的第一维长度为1。另外，如果存储的数据是多组的，那么这些组球谐系数的最大阶次一定是一致的。</p><p>一般来说，<code>SHC</code>不会直接拿来实例化，而是通过<code>load_SHC</code>等函数得到（具体请查看该系列相关文章）。不过仍然可以通过传入数据来得到其实例。具体操作为</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shc = SHC(c, s=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><p>有四种方式来传入参数：</p><ol type="1"><li>参数<code>c</code>和<code>s</code>都是二维的数组，均以<code>(l,m)</code>的索引方式分别给出cos系数和sin系数的单组球谐系数，其中l是阶索引，m是次索引；</li><li>参数<code>c</code>和<code>s</code>都是二维的数组，均以<code>(q,l,m)</code>的索引方式分别给出cos系数和sin系数的多组球谐系数，其中q是组数索引，l是阶索引，m是次索引；</li><li>参数<code>s</code>为None,<code>c</code>是表示一组完整球谐系数的一维数组，以<code>[c[0,0], s[1,1], c[1,0], c[1,1], s[2,2], s[2,1], ...]</code>的顺序给出；</li><li>参数<code>s</code>为None,<code>c</code>是表示多组完整球谐系数的二维数组，以<code>[[c1[0,0], s1[1,1], c1[1,0], ...], [c2[0,0], s2[1,1], c2[1,0], ...], ...]</code>的顺序给出。</li></ol><p>不论以哪种方式传入，<code>shc.value</code>的结构与按照前面所描述的一致。</p><h2 id="基本信息获取">基本信息获取</h2><p>如前所述，<code>SHC().value</code>是该类型以二维数组的形式给出，其第一维代表组数，可以用方法<code>SHC().get_length() -&gt; int</code>来得到组数个数，也可以用<code>SHC().is_series() -&gt; bool</code>来判断其是否为多组数据。<code>SHC().value</code>的第二维代表该组的球谐系数，因此，其长度一定是<span class="math inline">\((\text{lmax}+1)^2\)</span>，而不能是任意整数。其中<span class="math inline">\(\text{lmax}\)</span>是整数，代表最大的阶次数，可以用方法<code>SHC().get_lmax() -&gt; int</code>来得到最大的阶次数。</p><p>用法如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sh_array = np.array([</span><br><span class="line">    [c1[<span class="number">0</span>,<span class="number">0</span>], s1[<span class="number">1</span>,<span class="number">1</span>], c1[<span class="number">1</span>,<span class="number">0</span>], c1[<span class="number">1</span>,<span class="number">1</span>], s1[<span class="number">2</span>,<span class="number">2</span>], s1[<span class="number">2</span>,<span class="number">1</span>], c1[<span class="number">2</span>,<span class="number">0</span>], c1[<span class="number">2</span>,<span class="number">1</span>], c1[<span class="number">2</span>,<span class="number">2</span>], s1[<span class="number">3</span>,<span class="number">3</span>] ..., c1[<span class="number">96</span>,<span class="number">96</span>]],</span><br><span class="line">[c2[<span class="number">0</span>,<span class="number">0</span>], s2[<span class="number">1</span>,<span class="number">1</span>], c2[<span class="number">1</span>,<span class="number">0</span>], c2[<span class="number">1</span>,<span class="number">1</span>], s2[<span class="number">2</span>,<span class="number">2</span>], s2[<span class="number">2</span>,<span class="number">1</span>], c2[<span class="number">2</span>,<span class="number">0</span>], c2[<span class="number">2</span>,<span class="number">1</span>], c2[<span class="number">2</span>,<span class="number">2</span>], s2[<span class="number">3</span>,<span class="number">3</span>] ..., c2[<span class="number">96</span>,<span class="number">96</span>]],</span><br><span class="line">])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>shc = SHC(sh_array)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>shc.get_length()</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>shc.is_series()</span><br><span class="line"><span class="literal">True</span></span><br><span class="line">&gt;&gt;&gt;shc.get_lmax()</span><br><span class="line"><span class="number">96</span></span><br></pre></td></tr></table></figure><p>有时用户需要得到以二维矩阵形式给出的c,s系数，可以用方法<code>SHC().get_CS2d()</code>实现。该方法返回的是一个二维元组，分别是系数c构成的<code>numpy.ndarray</code>三维数组和s构成的<code>numpy.ndarray</code>三维数组。其中第一维度是组数，第二维度是阶索引l，第三维度是次索引m。注意即使<code>SHC().is_series() is False</code>，方法<code>SHC().get_CS2d()</code>返回的c和s仍然是三维的，此时第一维长度是1。具体如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sh_array = np.array([</span><br><span class="line">    [c1[<span class="number">0</span>,<span class="number">0</span>], s1[<span class="number">1</span>,<span class="number">1</span>], c1[<span class="number">1</span>,<span class="number">0</span>], c1[<span class="number">1</span>,<span class="number">1</span>], s1[<span class="number">2</span>,<span class="number">2</span>], s1[<span class="number">2</span>,<span class="number">1</span>], c1[<span class="number">2</span>,<span class="number">0</span>], c1[<span class="number">2</span>,<span class="number">1</span>], c1[<span class="number">2</span>,<span class="number">2</span>], s1[<span class="number">3</span>,<span class="number">3</span>] ..., c1[<span class="number">96</span>,<span class="number">96</span>]],</span><br><span class="line">[c2[<span class="number">0</span>,<span class="number">0</span>], s2[<span class="number">1</span>,<span class="number">1</span>], c2[<span class="number">1</span>,<span class="number">0</span>], c2[<span class="number">1</span>,<span class="number">1</span>], s2[<span class="number">2</span>,<span class="number">2</span>], s2[<span class="number">2</span>,<span class="number">1</span>], c2[<span class="number">2</span>,<span class="number">0</span>], c2[<span class="number">2</span>,<span class="number">1</span>], c2[<span class="number">2</span>,<span class="number">2</span>], s2[<span class="number">3</span>,<span class="number">3</span>] ..., c2[<span class="number">96</span>,<span class="number">96</span>]],</span><br><span class="line">])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>shc = SHC(sh_array)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c, s = SHC().get_CS2d()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c.shape, s.shape</span><br><span class="line">(<span class="number">1</span>, <span class="number">97</span>, <span class="number">97</span>), (<span class="number">1</span>, <span class="number">97</span>, <span class="number">97</span>)</span><br></pre></td></tr></table></figure><h2 id="球谐系数的加减">球谐系数的加减</h2><p><code>SHC</code>添加了魔法方法<code>__add__(self, other)</code>,<code>__sub__(self, other)</code>以实现两个<code>SHC</code>实例的加减运算，实现的本质是二者属性<code>value</code>的的加减。因此，它们的运算规则应该与相应的数组加减规则一致。如这句代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>shc_1 + shc_2</span><br></pre></td></tr></table></figure><p>返回的结果是一个新的<code>SHC</code>实例，其属性<code>value</code>应该等于<code>shc_1.value + shc_2.value</code>。并且计算过程中，应该满足下列条件之一：</p><ol type="1"><li><code>shc_2.value.shape == shc_1.value.shape</code>，即二者拥有同样的组数和最大阶次。此时分别计算每组对应系数的相加；</li><li><code>shc_2.is_series is False</code>，即<code>shc_2</code>仅代表一组球谐系数。此时<code>shc_1</code>中的每一组系数分别与<code>shc_2</code>代表的这一组系数相加。</li></ol><p>这些规则同样适用于相减的情况。</p><p>实际应用中，有时候可能只需要从某一阶开始或结束加减，此时可以使用方法<code>SHC().add(other, lbegin, lend)</code>和<code>SHC().value(other, lbegin, lend)</code>。其中参数<code>other</code>是<code>SHC</code>的实例，<code>lbegin</code>和<code>lend</code>均以<code>int</code>类型给出，分别代表从哪一阶开始（含）加减，从哪一阶结束（含）加减。返回的结果是自身按照相应规则加减被传入参数<code>other</code>后的<code>SHC</code>实例。具体如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>shc1 = SHC(np.array([</span><br><span class="line">    [c1[<span class="number">0</span>,<span class="number">0</span>], s1[<span class="number">1</span>,<span class="number">1</span>], c1[<span class="number">1</span>,<span class="number">0</span>], c1[<span class="number">1</span>,<span class="number">1</span>], s1[<span class="number">2</span>,<span class="number">2</span>], s1[<span class="number">2</span>,<span class="number">1</span>], c1[<span class="number">2</span>,<span class="number">0</span>], c1[<span class="number">2</span>,<span class="number">1</span>], c1[<span class="number">2</span>,<span class="number">2</span>], s1[<span class="number">3</span>,<span class="number">3</span>] ..., c1[<span class="number">61</span>,<span class="number">61</span>]],</span><br><span class="line">]))</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>shc2 = SHC(np.array([</span><br><span class="line">    [c2[<span class="number">0</span>,<span class="number">0</span>], s2[<span class="number">1</span>,<span class="number">1</span>], c2[<span class="number">1</span>,<span class="number">0</span>], c2[<span class="number">1</span>,<span class="number">1</span>], s2[<span class="number">2</span>,<span class="number">2</span>], s2[<span class="number">2</span>,<span class="number">1</span>], c2[<span class="number">2</span>,<span class="number">0</span>], c2[<span class="number">2</span>,<span class="number">1</span>], c2[<span class="number">2</span>,<span class="number">2</span>], s2[<span class="number">3</span>,<span class="number">3</span>] ..., c2[<span class="number">61</span>,<span class="number">61</span>]],</span><br><span class="line">]))</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>shc1.add(shc2, lbegin=<span class="number">0</span>, lend=<span class="number">1</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>shc1.value</span><br><span class="line">np.array([</span><br><span class="line">    [c1[<span class="number">0</span>,<span class="number">0</span>]+c2[<span class="number">0</span>,<span class="number">0</span>], s1[<span class="number">1</span>,<span class="number">1</span>] + s2[<span class="number">1</span>,<span class="number">1</span>], c1[<span class="number">1</span>,<span class="number">0</span>] + c2[<span class="number">1</span>,<span class="number">0</span>], c1[<span class="number">1</span>,<span class="number">1</span>] + c2[<span class="number">1</span>,<span class="number">1</span>], s1[<span class="number">2</span>,<span class="number">2</span>], s1[<span class="number">2</span>,<span class="number">1</span>], ...],</span><br><span class="line">])</span><br></pre></td></tr></table></figure><p>基于加减方法，<code>SHC()</code>还定义了<code>.de_background(background: SHC=None)</code>方法，即扣除背景场。参数<code>background</code>以<code>SHC</code>实例的形式传入，或者为<code>None</code>。如果。如果参数<code>background</code>是<code>SHC</code>实例，需要确保<code>background.is_series() if False</code>，即传入的背景场必须是单组球谐系数，此时返回的结果等价于自身每一组球谐系数减去背景场后构成的<code>SHC</code>实例。如果<code>back_ground is None</code>，则扣除自身所有组球谐系数的平均值。具体如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>shc.de_background(shc_bg).value == (shc - shc_bg).value</span><br><span class="line"><span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>shc.de_background().value == shc.value - numpy.mean(shc.value, axis=<span class="number">0</span>)</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure><h2 id="物理量转换和阶方差rssrms的获取">物理量转换和阶方差RSS、RMS的获取</h2><p>在评估重力场时，我们可能需要通过将无量纲的球谐系数转换为大地水准面高或等效水高后，通过阶方差信息来判断。</p><p>一般来说，重力场球谐产品以无量纲球谐系数的形式描述地球重力场在不同频段上的信息，而<code>SHC().convert_type(from_type, to_type)</code>可以将其两个转换为我们所需要的物理量。其中，参数<code>from_type</code>和<code>to_type</code>的类型应该是物理量纲类型<code>PhysicalDimensions</code>。</p><blockquote><p>SAGEA为一些固定的名称，如物理量纲、滤波器方法等等提供了对应的枚举类型，在<code>../pysrc/auxiliary/preference/EnumClasses.py</code>文件中。<code>PhysicalDimensions</code>定义了这些值：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PhysicalDimensions</span>(<span class="title class_ inherited__">Enum</span>):</span><br><span class="line">    Dimensionless = <span class="number">0</span>  <span class="comment"># 无量纲系数</span></span><br><span class="line">    EWH = <span class="number">1</span>  <span class="comment"># 等效水高 [m]</span></span><br><span class="line">    Pressure = <span class="number">2</span>  <span class="comment"># 压力 [bar]</span></span><br><span class="line">    Density = <span class="number">3</span>  <span class="comment"># 质量密度 [kg/m^3]</span></span><br><span class="line">    Geoid = <span class="number">4</span>  <span class="comment"># 大地水准面高 [m]</span></span><br><span class="line">    Gravity = <span class="number">5</span>  <span class="comment"># 重力 [mGal]</span></span><br><span class="line">    HorizontalDisplacementEast = <span class="number">6</span>  <span class="comment"># [m]</span></span><br><span class="line">    HorizontalDisplacementNorth = <span class="number">7</span>  <span class="comment"># [m]</span></span><br><span class="line">    VerticalDisplacement = <span class="number">8</span>  <span class="comment"># [m]</span></span><br></pre></td></tr></table></figure></blockquote><p>顾名思义，<code>from_type</code>定义自身目前代表的物理量类型，<code>to_type</code>定义了转换后的物理量类型。它们缺省值均为<code>None</code>，并且当传入<code>None</code>时，程序将为其赋值为<code>PhysicalDimensions.Dimensionless</code>。使用中，如果一个<code>SHC</code>实例在调用<code>.convert_type()</code>时会改变自身的值<code>.value</code>。</p><p>而阶方差的形式在不同情景下会使用RMS (Root Mean Squre)或RSS (Root SumSqure)，即 <span class="math display">\[\text{RMS}(l) = \left(\cfrac{1}{2l+1} \sum_{m=0}^l \left( C_{l,m}^2 +S_{l,m}^2 \right) \right) ^ {\cfrac{1}{2}} ,\]</span> 或 <span class="math display">\[\text{RSS}(l) = \left( \sum_{m=0}^l \left( C_{l,m}^2 + S_{l,m}^2 \right)\right) ^ {\cfrac{1}{2}} .\]</span>对应的<code>SHC()</code>方法分别是<code>.get_degree_rms()</code>和<code>.get_degree_rss()</code>。对于<code>.value.shape == (n, (lmax+1)^2)</code>情况，这两种方法返回的结果形状为<code>(n, lmax + 1)</code>，其中<code>n</code>是组数,<code>lmax</code>是最大阶数。具体使用如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pysrc.auxiliary.preference.EnumClasses <span class="keyword">as</span> Enums</span><br><span class="line"><span class="keyword">import</span> ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">shc = load_SHC(...)  <span class="comment"># 读取文件内容详见本系列对应文章</span></span><br><span class="line"></span><br><span class="line">shc.de_background()  <span class="comment"># 扣除平均场</span></span><br><span class="line"></span><br><span class="line">shc.convert_type(from_type=Enums.PhysicalDimensions.Dimensionless， to_type=Enums.PhysicalDimensions.Geoid)  <span class="comment"># 将无量纲系数转换为大地水准面高</span></span><br><span class="line"></span><br><span class="line">degree_array = np.arange(<span class="number">0</span>, shc.get_lmax() + <span class="number">1</span>, <span class="number">1</span>)  <span class="comment"># 得到阶序列，以便后续画图</span></span><br><span class="line"></span><br><span class="line">rms = shc.get_degree_rms()  <span class="comment"># 获取RMS</span></span><br><span class="line">rss = shc.get_degree_rss()  <span class="comment"># 获取RSS</span></span><br><span class="line"></span><br><span class="line">plot_index = <span class="number">10</span>  <span class="comment"># 随便定义一组来画图，不过当然不能超过组数</span></span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">5</span>, <span class="number">6</span>))</span><br><span class="line">ax = fig.add_axes([<span class="number">0.2</span>, <span class="number">0.1</span>, <span class="number">0.7</span>, <span class="number">0.8</span>])</span><br><span class="line"></span><br><span class="line">ax.plot(degree_array[<span class="number">2</span>:], rms[<span class="number">10</span>][<span class="number">2</span>:], label=<span class="string">&quot;RMS&quot;</span>)  <span class="comment"># GRACE二级重力场产品不提供0阶和1阶项信息，需要额外技术得到。所以从第2阶开始作图。</span></span><br><span class="line">ax.plot(degree_array[<span class="number">2</span>:], rss[<span class="number">10</span>][<span class="number">2</span>:], label=<span class="string">&quot;RSS&quot;</span>)</span><br><span class="line"></span><br><span class="line">ax.legend()</span><br><span class="line"></span><br><span class="line">ax.set_xlabel(<span class="string">&#x27;Degree&#x27;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&#x27;Geoid [m]&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax.set_yscale(<span class="string">&quot;log&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>上述代码得到的图片为</p><p><img src="/2025/03/05/SAGEA(1_1)_%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8BSHC/1_1.png"></p>]]></content>
      
      
      <categories>
          
          <category> SAGEA使用手册 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 卫星重力数据 </tag>
            
            <tag> GRACE </tag>
            
            <tag> 球谐产品 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>随机过程笔记：高斯过程(3)</title>
      <link href="/2024/09/07/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B3%E9%9D%9E%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F/"/>
      <url>/2024/09/07/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B3%E9%9D%9E%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<p>高斯过程是非常重要的一类随机过程，其应用在各领域都非常广泛。本文进一步研究了高斯过程在经历一些常见的非线性系统后的新特性。本文属于随机过程笔记，根据清华大学电子工程系张颢副研究员的随机过程线上课程笔记整理而成，<a href="https://www.bilibili.com/video/BV1V44y1z7yi?share_source=copy_web">这是课程链接</a>。</p><span id="more"></span><p>我们知道，高斯过程在经过线性变换后仍然是高斯的。本文将进一步研究，当非线性系统作用域高斯过程后，其将会有怎样的新性质。此前，我们快速回顾，常见的非线性系统包括：</p><ol type="1"><li>多项式</li><li>分段线性</li><li>指数函数</li><li>三角函数</li><li>对数函数</li></ol><p>其中对数函数的作用域是正数，而高斯过程是包含负数的，因此，我们仅讨论前四种非线性系统。对于这四种非线性系统，我们逐一分析。</p><p>在讨论高斯过程被作用于多项式系统前，我们先讨论高阶矩的相关问题，这在之后将会用到。</p><h1 id="高斯分布的高阶矩计算">高斯分布的高阶矩计算</h1><p>现有一个一维零均值的高斯分布 <span class="math display">\[X\sim N(0,\sigma),\]</span> 其均值（一阶矩）<span class="math inline">\(E(X)=0\)</span>，二阶矩<span class="math inline">\(E(X^2)=\text{Var}(X)+(E(X))^2=\sigma^2\)</span>.</p><p>现计算<span class="math inline">\(X\)</span>的<span class="math inline">\(n\)</span>阶矩： <span class="math display">\[E(X^n)=\cfrac{1}{\sqrt{2\pi}\sigma}\int_{-\infty}^\infty x^n \exp(-\cfrac{x^2}{2\sigma ^2})\text{d}x ,\]</span>显然，要计算这个积分，分部积分法大概率是一个好法子（指数部分可以在求导过程中保持不变，<span class="math inline">\(x^n\)</span>可以最终求导为<span class="math inline">\(x\)</span>或<span class="math inline">\(x^2\)</span>，得到的形式即我们熟悉的一阶矩和二阶矩）。令<span class="math display">\[I_n =\int_{-\infty}^\infty x^n \exp (-\cfrac{x^2}{2\sigma ^2})\text{d}x,\]</span> 有 <span class="math display">\[\begin{equation*}\begin{aligned}I_n &amp; =-\sigma ^2 \int_{-\infty}^\infty x^{n-1} \text{d} \exp(-\cfrac{x^2}{2\sigma ^2})\\&amp; = \left.-\sigma ^2 x^{n-1} \exp (-\cfrac{x^2}{2\sigma ^2})\right|_{-\infty}^\infty + \sigma ^2 \int_{-\infty}^\infty \exp(-\cfrac{x^2}{2\sigma ^2}) \text{d} x^{n-1} \\&amp; = 0 + (n-1) \sigma ^2 \int_{-\infty}^\infty x^{n-2} \exp(-\cfrac{x^2}{2\sigma ^2}) \text{d} x,\end{aligned}\end{equation*}\]</span> 即 <span class="math display">\[I_n = (n-1) \sigma ^2 I_{n-2}.\]</span> 进一步地，将<span class="math inline">\(n\)</span>分奇偶情况讨论。当<span class="math inline">\(n=2k\)</span>为偶数时， <span class="math display">\[I_n = (n-1) \sigma ^2 \cdot I_{n-2} = (n-1) \sigma ^2 \cdot (n-3) \sigma^2 \cdot I_{n-4} = \cdots = (n-1)(n-3) \cdots 3 \cdot \sigma^{2k} \cdotI_2,\]</span> 其中<span class="math inline">\(I_2=E(X^2)=\sigma^2\)</span>；而当<span class="math inline">\(n=2k+1\)</span>为奇数时，递推后最终得到的结果必然有一个因子<span class="math inline">\(I_1\)</span>，即<span class="math inline">\(E(X)=0\)</span>，故此时<span class="math inline">\(I_n\)</span>必然为零。</p><p>递推可以得到 <span class="math display">\[\begin{equation*} I_n = \left\{\begin{aligned}(n-1) !! \sigma^n &amp;, n=2k\\0 &amp;, n=2k+1\end{aligned}\right.\end{equation*},\]</span> 其中<span class="math inline">\(k=1,2,3,\cdots\)</span>为正整数。</p><h1 id="利用特征函数计算表示高阶矩">利用特征函数计算（表示）高阶矩</h1><p>我们知道，<strong>任意</strong>一个<span class="math inline">\(n\)</span>元随机矢量<span class="math inline">\(\mathbb{X}=(X_1, X_2, \cdots ,X_n)^\top\)</span>，其特征函数表示为 $$ <span class="math display">\[\begin{equation*}\begin{aligned}\Phi _\mathbb{X}(\omega) &amp; = E(\exp{\left(\text{i}\omega^\top\mathbb{X} \right)}) \\&amp; = E(\exp{\left( \text{i}(\omega_1 X_1 + \omega_2 X_2 + \cdots\omega_n X_n) \right)})，\end{aligned}\end{equation*}\]</span> <span class="math display">\[现在要求高阶矩$E(X_1^{\alpha_1} X_2^{\alpha_2} \cdotsX_n^{\alpha_n})$，我们可以考虑将上述的$\Phi_\mathbb{X}(\omega)$分别对$\omega_j$求$\alpha_j$次导，即\]</span> E(), <span class="math display">\[这里通过语言描述，当对$\omega_j$求$\alpha_j$次导数（此时指数部分中相应的系数是$\text{i}X_j$）后，期望表达式中，指数部分是不会变动的，而前面的系数将会多出$\alpha_j$个虚数单位$\text{i}^{\alpha_j}$和$X_j^{\alpha_j}$。类似地，当对每一个$X_k$都求$\alpha_k$次导后，期望表达式中，指数部分原封不动，而前面的系数则会是$\text{i}^{\alpha_1+ \alpha_2 + \cdots + \alpha_n}\cdot X_1^{\alpha_1} X_2^{\alpha_2}\cdots X_n^{\alpha_n}$，即\]</span> <span class="math display">\[\begin{equation*}\begin{aligned}\cfrac{\partial ^{(\alpha_1 + \alpha_2 + \cdots + \alpha_n)}}{\partial\omega_1^{\alpha_1}\omega_2^{\alpha_2}\cdots\omega_n^{\alpha_n}}E(\exp{\left( \text{i}(\omega_1 X_1 + \omega_2 X_2 + \cdots \omega_nX_n) \right)}) &amp; = E(\text{i}^{\alpha_1 + \alpha_2 + \cdots +\alpha_n}\cdot X_1^{\alpha_1} X_2^{\alpha_2} \cdots X_n^{\alpha_n} \cdot\exp{\left( \text{i}(\omega_1 X_1 + \omega_2 X_2 + \cdots \omega_n X_n)\right)}) \\&amp; = \text{i}^{\alpha_1 + \alpha_2 + \cdots + \alpha_n}E(X_1^{\alpha_1} X_2^{\alpha_2} \cdots X_n^{\alpha_n}) E(\exp{\left(\text{i}(\omega_1 X_1 + \omega_2 X_2 + \cdots \omega_n X_n) \right)})\end{aligned}\end{equation*}\]</span>, <span class="math display">\[再令上式中$\omega_1 = \omega_2 = \cdots \omega_n = 0$，得\]</span> . E() |_{_1 = _2 = _n = 0} = ^{_1 + _2 + + _n} E(X_1^{_1}X_2^{_2} X_n^{_n}), <span class="math display">\[即我们要求的高阶矩（至少从形式上）可以被表示为\]</span> E(X_1^{_1} X_2^{<em>2} X_n^{<em>n}) = . </em>() |</em>{= 0},$$ 其中，<span class="math inline">\(\Phi_\mathbb{X}(\omega)\)</span>是<span class="math inline">\(n\)</span>元随机矢量<span class="math inline">\(\mathbb{X}=(X_1, X_2, \cdots ,X_n)^\top\)</span>的特征函数。</p><h1 id="平方器与高斯过程">平方器与高斯过程</h1><p>我们从最简单的多项式入手。设有一个高斯过程满足零均值：<span class="math inline">\(E(\mathbb{X}(t))=0\)</span>，且宽平稳：<span class="math inline">\(E(\mathbb{X}(t)\mathbb{X}(s))=E_\mathbb{X}(t-s)=E_\mathbb{X}(\tau)\)</span>，现将一个平方算子作用在该高斯过程上：<span class="math display">\[\mathbb{X}(t)\stackrel{h(x)=x^2}{\longrightarrow}\mathbb{Y}(t).\]</span> 显然，<span class="math inline">\(\mathbb{Y}\)</span>不是高斯的，它起码连个负值都没有。那么，新得到的随机过程<span class="math inline">\(\mathbb{Y}(t)\)</span>有哪些性质呢？接下来我们逐一讨论它的分布情况，以及随机过程<span class="math inline">\(\mathbb{Y}(t)\)</span>的相关函数。</p><h2 id="均值与概率密度函数">均值与概率密度函数</h2><p>根据定义，<span class="math inline">\(\mathbb{Y}(t)\)</span>的均值计算非常简单，直接带进去就完了：<span class="math display">\[E(\mathbb{Y}(t))=E(\mathbb{X}^2(t))=R_\mathbb{X}(0),\]</span> 这里我们用到了假设中<span class="math inline">\(\mathbb{X}(t)\)</span>的宽平稳性质。</p><p>接下来，我们再来讨论<span class="math inline">\(\mathbb{Y}(t)\)</span>具体的分布情况。首先根据定义写出分布函数：$$ <span class="math display">\[\begin{equation*}\begin{aligned}F_{\mathbb{Y}(t)}(y) = &amp; P(\mathbb{Y}(t)\leq y) \\= &amp; P(\mathbb{X}^2(t)\leq y) \\= &amp; \left\{\begin{aligned}P(\left|\mathbb{X}(t)\right|\leq \sqrt{y}), &amp; y\geq0 \\0, &amp; y\lt 0\end{aligned}\right.\end{aligned}\end{equation*}\]</span> <span class="math display">\[这里仅考虑$y\geq 0$的情况：\]</span> P(|(t)|) = 2 <em>0^ f</em>{(t)}(s)s <span class="math display">\[其中，$f_{\mathbb{X}(t)}$是$\mathbb{X}(t)$的概率密度函数。进一步地，对上式求导即可得到$f_{\mathbb{Y}(t)}$的概率密度函数：\]</span> <span class="math display">\[\begin{equation*}\begin{aligned}f_{\mathbb{Y}(t)}(y) &amp;  =\cfrac{\text{d}}{\text{d}y}F_{\mathbb{Y}(t)}(y) \\&amp; = 2 f_{\mathbb{X}(t)}(\sqrt{y}) \cdot \cfrac{1}{2\sqrt{y}} \\&amp; = \cfrac{1}{\sqrt{y}} f_{\mathbb{X}(t)}(\sqrt{y})\end{aligned}\end{equation*}\]</span> <span class="math display">\[高斯分布的概率密度函数是已知的，并且这里假设$\mathbb{X}(t)$是宽平稳的，因此\]</span> f_{(t)}(y) = . <span class="math display">\[综上我们可以得到$\mathbb{Y}(t)$的概率密度函数：\]</span> <span class="math display">\[\begin{equation*}\begin{aligned}f_{\mathbb{Y}(t)}(y) &amp;  = \left\{\begin{aligned}\cfrac{1}{\sqrt{2\pi R_\mathbb{X}(0)y}}\exp{\left(-\cfrac{y}{2\piR_\mathbb{X}(0)}\right)}, &amp; y\geq0 \\0, &amp; y\lt 0\end{aligned}\right.\end{aligned}\end{equation*}\]</span>. $$ ## 相关函数</p><p>上述讨论的实际上是<span class="math inline">\(\mathbb{Y}(t)\)</span>在某一点的分布情况。作为随机过程，我们还应该关注其相关函数的表现如何。根据定义，<span class="math inline">\(\mathbb{Y}(t)\)</span>的相关函数表示为 $$ <span class="math display">\[\begin{equation*}\begin{aligned}R_\mathbb{Y}(t,s) &amp; = E(\mathbb{Y}(t)\mathbb{Y}(s)) \\&amp; = E(\mathbb{X}^2(t)\mathbb{X}^2(s)).\end{aligned}\end{equation*}\]</span> <span class="math display">\[这是一个高阶矩问题。根据之前的结论，一般形式的高阶矩可以被表示为\]</span> E(X_1^{<em>1} X_2^{<em>2} X_n^{<em>n}) = . </em>() |</em>{=0}, <span class="math display">\[其中，$\Phi_\mathbb{X}(\omega)$是$n$元随机矢量$\mathbb{X}=(X_1, X_2,\cdots ,X_n)^\top$的特征函数。而零均值、协方差为$\Sigma$的高斯过程的特征函数我们知道，是\]</span> </em>() = ( - ^), <span class="math display">\[联合上面的结论，经过繁琐但不困难的计算（这里就不详细展开了），相关函数$R_\mathbb{Y}(t,s)=E(\mathbb{X}^2(t)\mathbb{X}^2(s))$便很容易得到了：\]</span> <span class="math display">\[\begin{equation*}\begin{aligned}R_\mathbb{Y}(t,s) &amp; = E(\mathbb{X}^2(t)\mathbb{X}^2(s)) \\&amp; = R^2_\mathbb{X}(0)+2R^2_\mathbb{X}(t-s)\end{aligned}\end{equation*}\]</span> $$</p><blockquote><p>计算时需要注意，由于这里的<span class="math inline">\(\mathbb{X}\)</span>是零均值的，所以协方差的每一项就是对应的相关函数，即$$ <span class="math display">\[\begin{equation*}\begin{aligned}\Sigma_{ij} &amp; = C_\mathbb{X}(t_i,t_j) \\&amp; = R_\mathbb{X}(t_i,t_j)-E(\mathbb{X}(t_i))E(\mathbb{X}(t_j)) \\&amp; = R_\mathbb{X}(t_i,t_j) \\&amp; = R_\mathbb{X}(t_i-t_j)\end{aligned}\end{equation*}\]</span> $$</p></blockquote><h1 id="硬限幅器与高斯过程">硬限幅器与高斯过程</h1><p>所谓硬限幅器，在数学上指的就是符号函数。设有一个高斯过程满足零均值：<span class="math inline">\(E(\mathbb{X}(t))=0\)</span>，且宽平稳：<span class="math inline">\(E(\mathbb{X}(t)\mathbb{X}(s))=E_\mathbb{X}(t-s)=E_\mathbb{X}(\tau)\)</span>，现将一个平方算子作用在该高斯过程上：<span class="math display">\[\mathbb{X}(t)\stackrel{h(x)=\text{sgn}(x)}{\longrightarrow}\mathbb{Y}(t).\]</span> 其中， $$ <span class="math display">\[\begin{equation*}\text{sgn}(x) = \left\{\begin{aligned}1, &amp; x\gt0 \\-1, &amp; x\lt0 \\\end{aligned}\right.\end{equation*}\]</span>, $$</p><p>这里，<span class="math inline">\(\text{sgn}(x)\)</span>在<span class="math inline">\(x=0\)</span>处的取值对于我们之后的内容而言并不重要，因此没给定义。同样地，我们讨论<span class="math inline">\(\mathbb{Y}(t)\)</span>的均值函数和相关函数。</p><h2 id="均值函数">均值函数</h2><p>显然地不能再显然了，均值为0。 $$ <span class="math display">\[\begin{equation*}\begin{aligned}E(\mathbb{Y}(t)) = &amp; 1 \cdot p(\mathbb{X}(t)&gt;0) + (-1) \cdotp(\mathbb{X}(t)&lt;0) \\= &amp; p(\mathbb{X}(t)&gt;0) - p(\mathbb{X}(t)&lt;0) \\= &amp; 0 .\end{aligned}\end{equation*}\]</span> $$ 这里，由于<span class="math inline">\(\mathbb{X}(t)\)</span>是零均值的，故<span class="math inline">\(p(\mathbb{X}(t)&gt;0) =p(\mathbb{X}(t)&lt;0)\)</span>.</p><h2 id="相关函数">相关函数</h2><p>根据定义， $$ <span class="math display">\[\begin{equation*}\begin{aligned}R_\mathbb{Y} (t,s) = &amp; E(\mathbb{Y}(t)\mathbb{Y}(s)) \\= &amp; E(\text{sgn}(\mathbb{X}(t)) \text{sgn}(\mathbb{X}(s))) \\= &amp; 1 \cdot p(\mathbb{X}(t)\mathbb{X}(s)&gt;0) + (-1) \cdotp(\mathbb{X}(t)\mathbb{X}(s)&lt;0),\end{aligned}\end{equation*}\]</span> <span class="math display">\[这里，我们记$P =p(\mathbb{X}(t)\mathbb{X}(s)&gt;0)$。显然，$p(\mathbb{X}(t)\mathbb{X}(s)&lt;0)= 1-P$，故\]</span> R_ (t,s) = 2P-1. $$ 现在我们开始计算<span class="math inline">\(P\)</span>。</p><p>设<span class="math inline">\(\mathbb{X}(t)\mathbb{X}(s)\)</span>的联合概率密度如图？所示，并被表示为<span class="math display">\[f_{\mathbb{X}(t)\mathbb{X}(s)}(x_1,x_2) = \cfrac{1}{2\pi\sigma_1\sigma_2 \sqrt{1-\rho^2}} \exp \left[ -\cfrac{1}{2(1-\rho^2)} \left(\cfrac{x_1^2}{\sigma_1^2} + \cfrac{x_2^2}{\sigma_2^2} - 2\rho\cfrac{x_1}{\sigma_1} \cfrac{x_2}{\sigma_2} \right)\right],\]</span> 其中，<span class="math inline">\(\rho\)</span>是<span class="math inline">\(\mathbb{X}(t),\mathbb{X}(s)\)</span>的相关，即<span class="math inline">\(\rho = E(\mathbb{X}(t) \mathbb{X}(s))\)</span>。要求<span class="math inline">\(\mathbb{X}(t)\mathbb{X}(s)&gt;0\)</span>的概率，即对联合概率密度分布在第一、第三象限中积分，即图？的灰色区域：<span class="math display">\[P= \left( \int_0^\infty\int_0^\infty + \int_{-\infty}^0\int_{-\infty}^0\right) \cfrac{1}{2\pi\sigma_1 \sigma_2 \sqrt{1-\rho^2}} \exp \left[-\cfrac{1}{2(1-\rho^2)} \left( \cfrac{x_1^2}{\sigma_1^2} +\cfrac{x_2^2}{\sigma_2^2} - 2\rho \cfrac{x_1}{\sigma_1}\cfrac{x_2}{\sigma_2} \right)\right] \text{d}x_1 \text{d}x_2.\]</span> 接下来将花费一定篇幅来计算这一积分。</p>首先，观察到被积函数是关于原点对称的<span class="math inline">\(f_{\mathbb{X}(t)\mathbb{X}(s)}(x_1,x_2) =f_{\mathbb{X}(t)\mathbb{X}(s)}(-x_1,-x_2)\)</span>，而被积区域恰好也是关于原点对称的，这在图？中也很容易直观地被看出来，因此，积分可以被化简为<span class="math display">\[P= \int_0^\infty\int_0^\infty \cfrac{1}{\pi\sigma_1 \sigma_2\sqrt{1-\rho^2}} \exp \left[ -\cfrac{1}{2(1-\rho^2)} \left(\cfrac{x_1^2}{\sigma_1^2} + \cfrac{x_2^2}{\sigma_2^2} - 2\rho\cfrac{x_1}{\sigma_1} \cfrac{x_2}{\sigma_2} \right)\right] \text{d}x_1\text{d}x_2.\]</span> 为了让积分变量显得更简洁，我们进行换元<span class="math inline">\(y_1 = \cfrac{x_1}{\sigma_1\sqrt{1-\rho^2}}, y_2 =\cfrac{x_2}{\sigma_2\sqrt{1-\rho^2}}\)</span>,于是 $$ <span class="math display">\[\begin{equation*}\begin{aligned}P &amp; = \int_0^\infty\int_0^\infty \cfrac{1}{\pi\sigma_1 \sigma_2\sqrt{1-\rho^2}} \exp \left[ -\cfrac{1}{2(1-\rho^2)} \left((1-\rho^2)y_1^2 + (1-\rho^2)y_2^2 - 2\rho (1-\rho^2)y_1y_2\right)\right] (1-\rho^2)\sigma_1 \sigma_2  \text{d}y_1 \text{d}y_2 \\&amp; = \int_0^\infty\int_0^\infty \cfrac{1}{\pi} \sqrt{1-\rho^2} \exp\left[ -\cfrac{1}{2} \left(y_1^2 + y_2^2 - 2\rho y_1y_2 \right)\right]\text{d}y_1 \text{d}y_2.\end{aligned}\end{equation*}\]</span> <span class="math display">\[此时，我们发现被积函数中存在交叉项，让积分变得异常困难，于是第二次换元：$y_1=u+v,y_2=u-v$。这样的换元实际上就是对$y_1,y_2$的线性变换：\]</span> (<span class="math display">\[\begin{aligned}u\\v\end{aligned}\]</span><h1 id="section">)</h1>(<span class="math display">\[\begin{aligned}\frac{1}{2} &amp;&amp; \frac{1}{2} \\\frac{1}{2} &amp;&amp; -\frac{1}{2}\end{aligned}\]</span><p>)</p>(<span class="math display">\[\begin{aligned}y_1 \\y_2\end{aligned}\]</span><p>) <span class="math display">\[在这样的线性变换下，积分变量则变成了\]</span> <span class="math display">\[\begin{equation*}\text{d}y_1 \text{d}y_2 = \left|\left|\cfrac{\partial(y_1,y_2)}{\partial(u,v)}\right|\right|\text{d}u \text{d}v=\left|\left|\begin{aligned}1&amp;&amp;1\\\\1&amp;&amp;-1\end{aligned}\right|\right|\text{d}u \text{d}v= 2\text{d}u \text{d}v\end{equation*}\]</span> <span class="math display">\[而$\text{d}y_1\text{d}y_2$的积分区域如图？(a)的灰色区域所示，在上述线性变换下，积分区域成了图？(b)的灰色区域所示，将该区域记为$\text{Area}$。于是\]</span> <span class="math display">\[\begin{equation*}\begin{aligned}P &amp; = \int_0^\infty\int_0^\infty \cfrac{1}{\pi} \sqrt{1-\rho^2} \exp\left[ -\cfrac{1}{2} \left(y_1^2 + y_2^2 - 2\rho y_1y_2 \right)\right]\text{d}y_1 \text{d}y_2 \\&amp; = \iint_{\text{Area}} \cfrac{1}{\pi} \sqrt{1-\rho^2} \exp \left[-\cfrac{1}{2} \left((u+v)^2 + (u-v)^2 - 2\rho (u+v)(u-v) \right)\right]2\text{d}u \text{d}v\\&amp; = \iint_{\text{Area}} \cfrac{2}{\pi} \sqrt{1-\rho^2} \exp \left[-\left((1-\rho)u^2 + (1+\rho) v^2 \right)\right] \text{d}u \text{d}v.\end{aligned}\end{equation*}\]</span> <span class="math display">\[为了让积分显得更简洁，我们再做一次换元：$u^\prime=\sqrt{1-\rho}u,v^\prime=\sqrt{1+\rho}v$。此时，积分区域变成了图？(c)的灰色区域所示，其中$\theta=\arctan\cfrac{\sqrt{1+\rho}}{\sqrt{1-\rho}}$，并把该区域记$\text{Area}^\prime$，于是\]</span> <span class="math display">\[\begin{equation*}\begin{aligned}P &amp; = \iint_{\text{Area}} \cfrac{2}{\pi} \sqrt{1-\rho^2} \exp\left[- \left((1-\rho)u^2 + (1+\rho) v^2 \right)\right] \text{d}u\text{d}v \\&amp; = \iint_{\text{Area}^\prime} \cfrac{2}{\pi} \exp \left[-\left(u^{\prime\ 2} + v^{\prime\ 2} \right)\right] \text{d}u^{\prime}\text{d}v^{\prime}.\end{aligned}\end{equation*}\]</span> <span class="math display">\[到此，就很简单了，极坐标换元：$\text{d}u^\prime \text{d}v^\prime =r\text{d}r\text{d}\theta$，其中，$r:0\rightarrow\infty, \theta:\theta_0= -\arctan \cfrac{\sqrt{1+\rho}}{\sqrt{1-\rho}}\rightarrow \theta_1 =\arctan \cfrac{\sqrt{1+\rho}}{\sqrt{1-\rho}}$，于是\]</span> <span class="math display">\[\begin{equation*}\begin{aligned}P &amp; = \iint_{\text{Area}^\prime} \cfrac{2}{\pi} \exp \left[-\left(u^{\prime\ 2} + v^{\prime\ 2} \right)\right] \text{d}u \text{d}v\\&amp; = \int_{r=0}^\infty \int_{\theta=\theta_0}^\cfrac{2}{\pi} \exp \left(- r^2\right) r\text{d}r\text{d}\theta \\&amp; = -\cfrac{1}{\pi} \int_{r=0}^\infty \exp \left(- r^2\right)\text{d}(-r^2) \int_{\theta=\theta_0}^ \text{d}\theta\\&amp; = -\cfrac{1}{\pi} \cdot (-1) \cdot 2\arctan\cfrac{\sqrt{1+\rho}}{\sqrt{1-\rho}},\end{aligned}\end{equation*}\]</span> <span class="math display">\[即\]</span> P = . $$实际上，至此我们已经得到答案了。不过，当我们对照图？来考察这个答案时，不禁会思考这样一个问题：目前得到的<span class="math inline">\(P\)</span>似乎没有太直观的几何意义，这个<span class="math inline">\(P\)</span>跟图？中的灰色区域到底有何联系？当然我们可以猜想，当图？所示的联合高斯分布正相关越强（<span class="math inline">\(\rho\)</span>越接近<span class="math inline">\(1\)</span>），<span class="math inline">\(P\)</span>应该越大，反之，当图？所示的联合高斯分布正相关越强（<span class="math inline">\(\rho\)</span>越接近<span class="math inline">\(-1\)</span>），<span class="math inline">\(P\)</span>应该越小。为了验证这一猜想，我们可以利用三角函数的若干性质，来改写这个<span class="math inline">\(P\)</span>，使之具有更为直观的几何意义。</p><p>记<span class="math inline">\(\arctan\cfrac{\sqrt{1-\rho}}{\sqrt{1+\rho}}=\alpha\)</span>，代入三角函数公式<span class="math inline">\(\cos 2\alpha =\cfrac{1-\tan^2\alpha}{1+\tan^2\alpha}\)</span>，我们可以得到： <span class="math display">\[\cos 2\alpha = \cfrac{1-\tan^2\alpha}{1+\tan^2\alpha} =\cfrac{1-\cfrac{1-\rho}{1+\rho}}{1+\cfrac{1-\rho}{1+\rho}} = -\rho\]</span> 即 <span class="math display">\[\alpha = \cfrac{\arccos (-\rho)}{2} = \cfrac{1}{2} (\cfrac{\pi}{2}-  \arcsin (-\rho)) = \cfrac{\pi}{4} + \cfrac{\arcsin (\rho)}{2},\]</span> 综上， $$ <span class="math display">\[\begin{equation*}\begin{aligned}P &amp; = \cfrac{2}{\pi} \alpha \\&amp; = \cfrac{2}{\pi} \left( \cfrac{\pi}{4} + \cfrac{\arcsin (\rho)}{2}\right) \\&amp; = \cfrac{1}{2} + \cfrac{1}{\pi} \arcsin (\rho)，\end{aligned}\end{equation*}\]</span> $$ 即<span class="math inline">\(P =p(\mathbb{X}(t)\mathbb{X}(s)&gt;0) = \cfrac{1}{2} + \cfrac{1}{\pi}\arcsin (\rho)\)</span>。至此，我们可以很完美地将这个答案与图？中对应起来，并验证我们刚才的猜想了：当<span class="math inline">\(\mathbb{X}(t)\)</span>与<span class="math inline">\(\mathbb{X}(s)\)</span>越是正相关，即<span class="math inline">\(\rho\)</span>越接近<span class="math inline">\(1\)</span>，图？所示的椭圆区域越偏向于东北-西南方向，此时<span class="math inline">\(P\)</span>不断增大直至<span class="math inline">\(P\rightarrow 1, \rho \rightarrow1\)</span>；反之，当<span class="math inline">\(\mathbb{X}(t)\)</span>与<span class="math inline">\(\mathbb{X}(s)\)</span>越是负相关，即<span class="math inline">\(\rho\)</span>越接近<span class="math inline">\(-1\)</span>，图？所示的椭圆区域越偏向于东北-西南方向，此时<span class="math inline">\(P\)</span>不断减小直至<span class="math inline">\(P\rightarrow 0, \rho \rightarrow-1\)</span>；而当<span class="math inline">\(\mathbb{X}(t)\)</span>与<span class="math inline">\(\mathbb{X}(s)\)</span>接近独立时，即<span class="math inline">\(\rho\)</span>越接近<span class="math inline">\(0\)</span>，图？所示的椭圆区域就越接近正圆形，此时，此时<span class="math inline">\(P\)</span>将趋近至<span class="math inline">\(P\rightarrow \cfrac{1}{2}, \rho \rightarrow0\)</span>。</p><p>至此，我们可以得到<span class="math inline">\(\mathbb{Y}(t)=\text{sgn}(\mathbb{X}(t))\)</span>的相关函数为<span class="math display">\[R_\mathbb{Y} (t,s) = 2P-1 = \cfrac{2}{\pi} \arcsin (\rho).\]</span></p><h2 id="price-定理">Price 定理</h2><p>为了更好地计算高斯过程与非线性系统的相关计算，在此引入一个工具：Price定理。</p><blockquote><p><strong>Price 定理：</strong></p><p>对于一个均值分别为<span class="math inline">\(0,0\)</span>，方差分别为<span class="math inline">\(\sigma_1^2,\sigma_2^2\)</span>，相关系数为<span class="math inline">\(\rho\)</span>的联合高斯分布<span class="math inline">\((X_1,X_2)\sim N\)</span>，和一个非线性函数<span class="math inline">\(g(x_1,x_2)\)</span>，有 <span class="math display">\[\cfrac{\partial E (g(X_1,X_2))}{\partial \rho} = \sigma_1 \sigma_2E\left(\cfrac{\partial^2g}{\partial x_1 \partial x_2} (X_1,X_2)\right).\]</span></p></blockquote><p>以刚才我们限幅器下高斯过程的相关函数计算为例，</p><p>第一步，确定<span class="math inline">\(g(X_1,X_2)=\text{sgn}(X_1)\text{sgn}(X_2)\)</span>；</p><p>第二步，计算<span class="math inline">\(g\)</span>的导数： <span class="math display">\[\cfrac{\partial^2g}{\partial x_1 \partial x_2} (X_1,X_2) =2\delta(X_1)\cdot 2\delta(X_2) = 4\delta(X_1)\delta(X_2);\]</span></p><blockquote><p>这里，<span class="math inline">\(\delta(\cdot)\)</span>是狄拉克函数，或称冲击函数，在数学中是一种抽象函数：<span class="math display">\[\begin{equation*}\delta (x-x_0) = \left\{\begin{aligned}+\infty, &amp; x=x_0 \\0, &amp; \text{elsewhere}\end{aligned}\right.\end{equation*}\]</span> 且满足： <span class="math display">\[\int_{-\infty}^\infty \delta (x) \text{d}x = 1.\]</span> 一般地，为方便计算，无特别说明时，取<span class="math inline">\(x_0 = 0\)</span>。</p><p>狄拉克函数是很好的泛函分析工具，我们用到了或将用到其这些性质（在此就不展开证明了）：</p><p><strong>与阶跃函数的关系</strong></p><p>狄拉克<span class="math inline">\(\delta\)</span>函数可以看作是阶跃函数<span class="math inline">\(H(x)\)</span>的导数，表达为： <span class="math display">\[\cfrac{\text{d}}{\text{d}x}H(x)=\delta(x),\]</span> 而符号函数可以被阶跃函数表示为 <span class="math display">\[\text{sgn}(x)=2H(x)-1,\]</span> 故有 <span class="math display">\[\cfrac{\text{d}}{\text{d}x}\text{sgn}(x)=2\delta(x).\]</span></p><p><strong>抽取性质</strong> 对于任意的连续函数<span class="math inline">\(f(x)\)</span>，我们有： <span class="math display">\[\int_{-\infty}^\infty f(x)δ(x−x_0) dx=f(x_0),\]</span> 也就是说，<span class="math inline">\(\delta\)</span>函数在积分中使得<span class="math inline">\(f(x)\)</span>只在点<span class="math inline">\(x=x_0\)</span>作出贡献，因此它起到了在积分中“选取”函数<span class="math inline">\(f(x)\)</span>在<span class="math inline">\(x_0\)</span>处的值的作用。</p></blockquote><p>第三步，计算Price等式右端： $$ <span class="math display">\[\begin{equation*}\begin{aligned}\sigma_1 \sigma_2E\left(\cfrac{\partial^2g}{\partial x_1 \partial x_2}(X_1,X_2)\right) &amp; = \sigma_1\sigma_2\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}\cfrac{\partial^2g (X_1,X_2)}{\partial x_1 \partial x_2}f_{X_1,X_2}(x_1,x_2)\text{d}x_1 \text{d}x_2\\&amp; = \sigma_1 \sigma_2\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}\cfrac{1}{2\pi \sigma_1 \sigma_2 \sqrt{1-\rho^2}}4\delta(X_1)\delta(X_2) \exp \left[ -\cfrac{1}{2(1-\rho^2)} \left(\cfrac{x_1^2}{\sigma_1^2} + \cfrac{x_2^2}{\sigma_2^2} - 2\rho\cfrac{x_1}{\sigma_1} \cfrac{x_2}{\sigma_2} \right)\right] \text{d}x_1\text{d}x_2 \\&amp; = \cfrac{2}{\pi \sqrt{1-\rho^2}} \left.\exp \left[-\cfrac{1}{2(1-\rho^2)} \left( \cfrac{x_1^2}{\sigma_1^2} +\cfrac{x_2^2}{\sigma_2^2} - 2\rho \cfrac{x_1}{\sigma_1}\cfrac{x_2}{\sigma_2} \right)\right]\right|_{x_1=x_2=0} \\&amp; = \cfrac{2}{\pi \sqrt{1-\rho^2}}.\end{aligned}\end{equation*}\]</span> <span class="math display">\[代入Price等式可得：\]</span> = . <span class="math display">\[记$E (g(X_1,X_2)) = h(\rho)$，则解微分方程\]</span> h() = . <span class="math display">\[为了解这一微分方程，首先找到其初值，显然$\left.h(\rho)\right|_{\rho=0}$是比较好找的。当$\rho=0$时，意味着$X_1,X_2$独立，立即得到\]</span> <span class="math display">\[\begin{equation*}\begin{aligned}h(0) &amp; = E (g(X_1,X_2)) \\ &amp; = E(\text{sgn}(X_1)\text{sgn}(X_2))\\ &amp; = E(\text{sgn}(X_1)) \cdot E(\text{sgn}(X_2))\\ &amp; =0,\end{aligned}\end{equation*}\]</span> <span class="math display">\[故\]</span> h() - h(0) = _0^ s <span class="math display">\[立即得到\]</span> h() = (), <span class="math display">\[即\]</span> E ((X_1)(X_2)) = (). $$这与上一节求高斯过程经过硬限幅器系统后的相关函数结论一致，少走不少弯路。</p><blockquote><p>你就说Price它好不好使吧。</p><p>——张颢</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 学习笔记：随机过程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数学 </tag>
            
            <tag> 随机过程 </tag>
            
            <tag> 高斯过程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>随机过程笔记：高斯过程(2)</title>
      <link href="/2023/03/19/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B2/"/>
      <url>/2023/03/19/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B2/</url>
      
        <content type="html"><![CDATA[<p>高斯过程是非常重要的一类随机过程，其应用在各领域都非常广泛。本文介绍了高斯过程的一些重要性质，简单说明了高斯过程的应用场景。本文属于随机过程笔记，根据清华大学电子工程系张颢副研究员的随机过程线上课程笔记整理而成，<a href="https://www.bilibili.com/video/BV1V44y1z7yi?share_source=copy_web">这是课程链接</a>。</p><span id="more"></span><h1 id="高斯过程的性质">高斯过程的性质</h1><h2 id="基本性质验证概率的非负性和归一性">基本性质验证：概率的非负性和归一性</h2><p>在研究高斯过程的性质之前，我们先来验证多元高斯分布概率密度函数是合法的（当然不得不合法，不过我们据此可以熟悉一下矩阵-向量的运算）。</p><p>概率密度函数最基本地满足两点要求：</p><ol type="1"><li><p>非负性 <span class="math display">\[f\geq0\]</span></p></li><li><p>归一性 <span class="math display">\[\int f =1\]</span></p></li></ol><p>前面已经给出，多元高斯分布地概率密度函数为</p><p><span class="math display">\[f_\mathbb{X}(x)=\cfrac{1}{(2\pi)^\frac{n}{2}(\det\Sigma)^\frac{1}{2}}\exp\left(-\cfrac{1}{2}(x-\mu)^\mathrm{T}\Sigma^{-1}(x-\mu)\right)\]</span></p><p>对于非负性，<span class="math inline">\(e\)</span>指数部分显然非负。而协方差矩阵<span class="math inline">\(\Sigma=E((x-\mu)(x-\mu)^\mathrm{T})\)</span>是实对称的，且所有主元<span class="math inline">\(\Sigma_{ii} =E((x_i-\mu_i)^2)\)</span>都是非负的，故<span class="math inline">\(\Sigma\)</span>是正定的。</p><blockquote><p>不妨回头看看实对称矩阵正定的几个等价充要条件。</p></blockquote><p>因此，作为分母，其行列式恒为正。至此，非负性已得到了验证。</p><p>对于归一性，我们可以直接开始计算 <span class="math display">\[\int_{\mathbb{R}^n}f_X(x)\mathrm{d}x = \cfrac{1}{(2\pi) ^ \frac{n}{2}(\det\Sigma) ^ \frac{1}{2}} \int_{\mathbb{R}^n} \exp \left(-\cfrac{1}{2}(x-\mu)^\mathrm{T}\Sigma^{-1} (x-\mu) \right)\mathrm{d}x_1\mathrm{d}x_2\cdots\mathrm{d}x_n\]</span></p><p>这个积分中，可以认为最难搞的就是被积函数中<span class="math inline">\(e\)</span>指数上的<span class="math inline">\(\Sigma^{-1}\)</span>了。稍加思考，<span class="math inline">\(\Sigma\)</span>是对称且正定的，因此可以将其对角化，写作这样的形式<span class="math display">\[\Sigma = U^\mathrm{T}\Lambda U\]</span> 其中，<span class="math inline">\(U\)</span>是正交的，<span class="math inline">\(U^\mathrm{T}U=UU^\mathrm{T}=I\)</span>；<span class="math inline">\(\Lambda\)</span>是对角阵，<span class="math inline">\(\Lambda = \mathrm{diag}(\lambda_1, \lambda_2,\cdots, \lambda_n)\)</span>。进一步地，有 <span class="math display">\[\Sigma = U^\mathrm{T} \Lambda^{\frac{1}{2}}U U^\mathrm{T}\Lambda^{\frac{1}{2}}U, \\\Sigma^{-1} =  U^\mathrm{T} \Lambda^{-\frac{1}{2}}U U^\mathrm{T}\Lambda^{-\frac{1}{2}}U = B^{\mathrm{T}} B\]</span> 其中，<span class="math inline">\(B = U^\mathrm{T}\Lambda^{-\frac{1}{2}}U\)</span>。</p><p>于是，暂时抛开常数项，积分部分 <span class="math display">\[\int_{\mathbb{R}^n} \exp \left(-\cfrac{1}{2}(x-\mu)^\mathrm{T}\Sigma^{-1} (x-\mu) \right)\mathrm{d}x_1\mathrm{d}x_2\cdots\mathrm{d}x_n  =  \int_{\mathbb{R}^n}\exp \left( -\cfrac{1}{2}(x-\mu)^\mathrm{T}B^{\mathrm{T}} B (x-\mu)\right) \mathrm{d}x_1\mathrm{d}x_2\cdots\mathrm{d}x_n \\\]</span> 令<span class="math inline">\(y=B(x-\mu)\)</span>，则有<span class="math inline">\(y^\mathrm{T}=(x-\mu)^\mathrm{T}B^\mathrm{T}\)</span>，积分元<span class="math display">\[\left( \cfrac{\mathrm{d}y}{\mathrm{d}x} \right) = B \Rightarrow\mathrm{d}x = (\det B)^{-1}\mathrm{d}y\]</span></p><blockquote><p>具体可以看看雅可比积分换元。</p></blockquote><p>于是上面积分就变为了 <span class="math display">\[\int_{\mathbb{R}^n} \exp \left( -\cfrac{1}{2}y^{\mathrm{T}} y \right)(\det B)^{-1}\mathrm{d}y\]</span></p><p>其中，<span class="math inline">\((\det B)^{-1} = (\det\Sigma)^{\frac{1}{2}}\)</span>，故积分可以继续写作 <span class="math display">\[\int_{\mathbb{R}^n} \exp \left( -\cfrac{1}{2}y^{\mathrm{T}} y \right)(\det \Sigma)^{\frac{1}{2}}\mathrm{d}y = (\det \Sigma)^{\frac{1}{2}}\int_{\mathbb{R}^n} \exp \left( -\cfrac{1}{2}y^{\mathrm{T}} y \right)\mathrm{d}y\]</span> 注意这里<span class="math inline">\(y^{\mathrm{T}}y=\sum_{k=1}^{n}y_k^2\)</span>，再将前面的系数代回，计算<span class="math inline">\(f_X\)</span>在全空间的积分，有 <span class="math display">\[\begin{equation*}\begin{aligned}\int_{\mathbb{R}^n} f_X(x)\mathrm{d}x &amp; =  \int_{\mathbb{R}^n}\cfrac{1}{(2\pi) ^ \frac{n}{2} (\det\Sigma) ^ \frac{1}{2}} \exp \left(-\cfrac{1}{2}(x-\mu)^\mathrm{T}\Sigma^{-1} (x-\mu) \right) \mathrm{d}x\\&amp; =  \cfrac{1}{(2\pi) ^ \frac{n}{2} (\det\Sigma) ^ \frac{1}{2}}\left((\det \Sigma)^{\frac{1}{2}} \int_{\mathbb{R}^n} \exp \left(-\cfrac{1}{2}y^{\mathrm{T}} y \right) \mathrm{d}y \right) \\&amp; =  \cfrac{1}{(2\pi) ^ \frac{n}{2} } \int_{\mathbb{R}^n} \exp\left( -\cfrac{1}{2}\sum_{k=1}^{n}y_k^2 \right) \mathrm{d}y \\&amp; =  \prod_{k=1}^{n} \left( \cfrac{1}{(2\pi) ^ \frac{1}{2} }\int_{\mathbb{R}^n} \exp \left( -\cfrac{1}{2}y_k^2 \right) \mathrm{d}y_k\right) \\\end{aligned}\end{equation*}\]</span> 括号内积分项可以转换在极坐标下进行很同意得到结果为<span class="math inline">\(\sqrt{2\pi}\)</span>。至此我们可以得到最终结果<span class="math display">\[\int_{\mathbb{R}^n}f_X(x)\mathrm{d}x = 1\]</span> 即多元高斯分布的概率密度函数在整个定义空间上的积分确实是<span class="math inline">\(1\)</span>。</p><h2 id="线性不变性linearity-invariance">线性不变性(LinearityInvariance)</h2><p>定义<span class="math inline">\(\mathbb{X}\in\mathbb{R}^n\)</span>是<span class="math inline">\(n\)</span>维高斯随机变量，<span class="math inline">\(\mathbb{X}\sim N(\mu,\Sigma)\)</span>；<span class="math inline">\(A\in \mathbb{R}^{m\times n}\)</span>是<span class="math inline">\(m\times n\)</span>的线性变换矩阵，且<span class="math inline">\(\mathbb{Y} = A\mathbb{X}\)</span>。那么一定有<span class="math display">\[\mathbb{Y} \sim (A\mu, A\Sigma A^{\mathrm{T}})\]</span>通俗地讲，高斯分布的经过线性变换后仍然是高斯分布的。验证这个结论很简单，不过需要一个前提工作，也就是要得到<span class="math inline">\(\mathbb{X}\)</span>的特征函数</p><blockquote><p><span class="math display">\[\Phi_\mathbb{X}(\omega) = E \left( \exp(i\omega^\mathrm{T}\mathbb{X})\right) = \exp \left( i\omega^{\mathrm{T}} \mu - \cfrac{1}{2}\omega^{\mathrm{T}}\Sigma \omega \right)\]</span></p><p>特征函数是研究随机过程一项很重要的工具，后面会经常用到。这里不妨自己先验证一下，后续有时间我再补充。</p></blockquote><p>据此我们写出<span class="math inline">\(\mathbb{Y}\)</span>的特征函数<span class="math display">\[\begin{equation*}\begin{aligned}\Phi_\mathbb{Y}(\omega) &amp; =  E \left(\exp(i\omega^\mathrm{T}\mathbb{Y}) \right) \\&amp; =  E \left( \exp(i\omega^\mathrm{T} A\mathbb{X}) \right) \\&amp; =  E \left( \exp(i (A^\mathrm{T}\omega)^\mathrm{T} \mathbb{X})\right)\end{aligned}\end{equation*}\]</span> 这实际上就是<span class="math inline">\(\mathbb{X}\)</span>的特征函数<span class="math inline">\(\Phi_\mathbb{X}(\omega^\prime)\)</span>在<span class="math inline">\(\omega^\prime = A^\mathrm{T}\omega\)</span>处的取值，故 <span class="math display">\[\begin{equation*}\begin{aligned}\Phi_\mathbb{Y}(\omega) &amp; = \left. \exp \left( i(\omega^\prime)^{\mathrm{T}} \mu - \cfrac{1}{2}(\omega^\prime) ^{\mathrm{T}}\Sigma(\omega^\prime) \right) \right|_{\omega^\prime = A^\mathrm{T} \omega} \\&amp; = \exp \left( i\omega^\mathrm{T}A \mu -\cfrac{1}{2}\omega^\mathrm{T}A\Sigma A^\mathrm{T} \omega \right)\end{aligned}\end{equation*}\]</span> 观察这里结果的形式，特征函数<span class="math inline">\(\Phi_\mathbb{Y}(\omega)\)</span>实际上就是高斯分布<span class="math inline">\(N(A\mu, A\SigmaA^\mathrm{T})\)</span>所对应的特征函数。至此，<span class="math inline">\(\mathbb{Y} \sim (A\mu, A\SigmaA^{\mathrm{T}})\)</span>得证。</p><h2 id="联合分布joint-distribution与边缘分布marginal-distribution">联合分布(JointDistribution)与边缘分布(Marginal Distribution)</h2><p>现在来考察多维随机变量联合高斯分布和边缘高斯分布的关系。</p><p>现有<span class="math inline">\(\mathbb{X} = \left( X_1, X_2, \cdots, X_n\right)^\mathrm{T}\)</span>，另<span class="math inline">\(\widetilde{\mathbb{X}} = \left( X_{n_1}, X_{n_2},\cdots , X_{n_k}\right)^\mathrm{T}\)</span>，其中， <span class="math inline">\(n_1, n_2, \cdots , n_k \in\left(1,2,\cdots,n\right)\)</span>。根据前面的线性不变性，<span class="math inline">\(\widetilde{\mathbb{X}}\)</span>显然也是高斯的。即，联合高斯分布是能充分说明其边缘分布也是高斯的。</p><p>这个结论反过来成立吗？答案是未必的。那么要如何判断多维随机变量的高斯性呢？这里给出一个判据：</p><blockquote><p>对随机变量<span class="math inline">\(\mathbb{X} \in\mathbb{R}^n,\forall \alpha \in \mathbb{R}^n\)</span>，都有<span class="math inline">\(\alpha^{\mathrm{T}} \mathbb{X} \sim N\)</span>是（一维）高斯分布的，则<span class="math inline">\(\mathbb{X}\simN\)</span>是多元高斯分布的。</p></blockquote><p>实际上这是一个充分必要条件。下面来证明。</p><p><strong>必要性“<span class="math inline">\(\Leftarrow\)</span>”</strong></p><p>这里必要性是显然的，实际上是线性不变性的一种特殊情况而已。</p><p><strong>充分性“<span class="math inline">\(\Rightarrow\)</span>”</strong></p><p>证：根据定义，写出随机变量<span class="math inline">\(\mathbb{X}\)</span>的特征函数 <span class="math display">\[\Phi_\mathbb{X}(\omega) = E\left( \exp\left(i\omega^\mathrm{T}\mathbb{X} \right) \right)\]</span> 由于目前还不知道<span class="math inline">\(\mathbb{X}\)</span>的情况，不太好继续往下写了。然而这里我们已知<span class="math inline">\(\forall \alpha \in \mathbb{R}^n\)</span>,都有<span class="math inline">\(\alpha^{\mathrm{T}} \mathbb{X} \simN\)</span> ，那么把上面式中<span class="math inline">\(\omega^\mathrm{T}\mathbb{X}\)</span>整体看作一个（一维的）随机变量，这个随机变量根据已知条件就可以知道是高斯的了。又根据特征函数的形式，我们可以把上式看作是<span class="math inline">\(\omega^\mathrm{T}\mathbb{X}\)</span>的特征函数<span class="math inline">\(\Phi_{\omega^\mathrm{T}\mathbb{X}}(\omega^\prime)\)</span>在<span class="math inline">\(\omega^\prime = 1\)</span>处的取值，即 <span class="math display">\[\begin{equation*}\begin{aligned}\Phi_\mathbb{X}(\omega) &amp; = \left.\Phi_{\omega^\mathrm{T}\mathbb{X}}(\omega^\prime) \right|_{\omega^\prime= 1} \\&amp; = \exp\left( i\mu_{\omega^\mathrm{T}\mathbb{X}} -\cfrac{1}{2}\sigma_{\omega^\mathrm{T}\mathbb{X}}^2 \right)\end{aligned}\end{equation*}\]</span></p><p>其中，<span class="math inline">\(\mu_{\omega^\mathrm{T}\mathbb{X}} ,\sigma_{\omega^\mathrm{T}\mathbb{X}}^2\)</span>分别是一维随机变量<span class="math inline">\(\omega^\mathrm{T}\mathbb{X}\)</span>的均值和方差。现计算之。</p><p><span class="math display">\[\begin{equation*}\begin{aligned}\mu_{\omega^\mathrm{T}\mathbb{X}} &amp; = E\left(\omega^\mathrm{T}\mathbb{X} \right) = \omega^\mathrm{T}E\left(\mathbb{X}\right) = \omega^\mathrm{T}\mu \\\\\sigma_{\omega^\mathrm{T}\mathbb{X}}^2 &amp; = E\left( \left(\omega^\mathrm{T}\mathbb{X} - E\left( \omega^\mathrm{T}\mathbb{X}\right) \right)^2 \right) \\&amp; = E\left( \left( \omega^\mathrm{T} \mathbb{X} -  \omega^\mathrm{T}\mu \right)^2\right) \\&amp; = \omega^\mathrm{T} E\left( \left( \mathbb{X} -  \mu \right)\left( \mathbb{X} -  \mu \right)^\mathrm{T} \right) \omega \\&amp; = \omega^\mathrm{T}\Sigma \omega^\mathrm{T}\end{aligned}\end{equation*}\]</span></p><p>故</p><p><span class="math display">\[\begin{equation*}\begin{aligned}\Phi_\mathbb{X}(\omega) &amp; = \left.\Phi_{\omega^\mathrm{T}\mathbb{X}}(\omega^\prime) \right|_{\omega^\prime= 1} \\&amp; = \exp\left( i\mu_{\omega^\mathrm{T}\mathbb{X}} -\cfrac{1}{2}\sigma_{\omega^\mathrm{T}\mathbb{X}}^2 \right) \\&amp; = \exp\left( i\omega^\mathrm{T}\mu -\cfrac{1}{2}\omega^\mathrm{T}\Sigma \omega^\mathrm{T} \right)\end{aligned}\end{equation*}\]</span></p><p>得到标标准准的高斯分布特征函数。故<span class="math inline">\(\mathbb{X} \sim N(\mu,\Sigma)\)</span>是服从联合高斯分布的。</p><p>至此，上述结论的充分性和必要性都得到了证明。</p><h2 id="相关性correlation与独立性independence">相关性(Correlation)与独立性(Independence)</h2><p>首先需要明白的是，相关是描述随机变量在二阶矩上的联系，独立性是以概率密度函数来描述的随机变量之间的联系。</p><blockquote><p>现有随机变量<span class="math inline">\(X, Y\in\mathbb{R}^n\)</span>，其概率密度分布函数和联合概率密度分布函数分别是<span class="math inline">\(f_X(x), f_Y(y), f_{XY}(x,y)\)</span>，那么</p><ol type="1"><li>若<span class="math inline">\(E(XY)=E(X)E(Y)\)</span>，则称随机变量<span class="math inline">\(X,Y\)</span>是不相关的；</li><li>若<span class="math inline">\(f_{XY}(x,y) =f_X(x)f_Y(y)\)</span>，则称随机变量<span class="math inline">\(X,Y\)</span>是独立的。</li></ol></blockquote><p>从定义来看，<strong>独立(Independent)的条件是要强于不相关(Uncorrelated)的</strong>，即<span class="math display">\[X, Y \left\{\begin{array}{rcl}\text{independent} &amp; \Rightarrow &amp; \text{uncorrelated} \\\text{uncorrelated} &amp; \not \Rightarrow &amp; \text{independent}\end{array}\right.\]</span> 这随便通过一个例子就能看出：</p><p>设<span class="math inline">\(\theta \simU(0,2\pi)\)</span>满足均匀分布，构建随机变量<span class="math inline">\(X=\cos(\theta), Y=\sin(\theta)\)</span>。显然<span class="math inline">\(X,Y\)</span>不独立；计算其相关： <span class="math display">\[E(X) = E(\cos \theta) = 0,\\E(Y) = E(\sin \theta) = 0,\\E(XY) = E(\cos\theta \sin\theta) = \cfrac{1}{2}(\sin 2\theta) = 0\]</span> 故<span class="math inline">\(E(X)E(Y)=E(XY)\)</span>。尽管<span class="math inline">\(X,Y\)</span>不独立，不过也是不相关的。</p><p>那么，如果是高斯分布的随机变量<span class="math inline">\(X,Y\)</span>，它们独立就能等价不相关吗？继续来个例子：</p><p>设<span class="math inline">\(X\simN(0,1)\)</span>是服从高斯分布的，又有伯努利随机变量<span class="math inline">\(Z\sim \left( \begin{array}{} 1 &amp; -1\\\cfrac{1}{2} &amp; \cfrac{1}{2} \end{array} \right)\)</span>，构建<span class="math inline">\(Y = ZX\)</span></p><ol type="1"><li><p><span class="math inline">\(Y\)</span>是高斯的吗？看特征函数。<span class="math display">\[\begin{equation*}\begin{aligned}\Phi_Y(\omega) &amp; = E\left(\exp (i\omega Y)\right) \\&amp; = E\left(\exp (i\omega ZX)\right)\\&amp; = E_Z\left( E_X\left(\left. \exp (i\omega ZX) \right|Z \right)\right)\end{aligned}\end{equation*}\]</span> 其中，<span class="math inline">\(E_X\)</span>项在，<span class="math inline">\(Z\)</span>被“条件住”了，在此可以看作是常量，这一项可以看作是<span class="math inline">\(X\)</span>的特征函数<span class="math inline">\(\Phi_X(\omega^\prime)\)</span>在<span class="math inline">\(\omega^\prime = \omega Z\)</span>处的取值 <span class="math display">\[\begin{equation*}\begin{aligned}E_X\left(\left. \exp (i\omega ZX) \right|Z \right) &amp; = \left.\Phi_X(\omega^\prime) \right|_{\omega^\prime = \omega Z} \\&amp; = \exp \left( i\omega Zm - \cfrac{1}{2}\sigma^2 (\omega Z)^2\right)\end{aligned}\end{equation*}\]</span> 其中，由于<span class="math inline">\(X\simN(0,1)\)</span>，故这里的<span class="math inline">\(m=0, \sigma^2 =1\)</span>。于是 <span class="math display">\[\begin{equation*}\begin{aligned}\Phi_Y(\omega) &amp; = E_Z\left( E_X\left(\left. \exp (i\omega ZX)\right|Z \right) \right) \\&amp; = E\left( \exp \left(i\omega Zm - \cfrac{1}{2}\sigma^2 (\omegaZ)^2 \right) \right) \\&amp; = E\left( \exp \left(- \cfrac{1}{2}\omega^2 Z^2 \right) \right) \\\end{aligned}\end{equation*}\]</span> 由于<span class="math inline">\(Z\sim \left( \begin{array}{} 1&amp; -1\\ \cfrac{1}{2} &amp; \cfrac{1}{2} \end{array}\right)\)</span>，因此不论取<span class="math inline">\(1\)</span>还是<span class="math inline">\(-1\)</span>，<span class="math inline">\(Z^2\equiv 1\)</span>。故 <span class="math display">\[\Phi_Y(\omega) = \exp(-\cfrac{1}{2}\omega ^2)\]</span> 因此，<span class="math inline">\(Y\)</span>是标标准准的高斯分布<span class="math inline">\(Y\sim N(0,1)\)</span>。</p></li><li><p><span class="math inline">\(X,Y\)</span>相关吗？计算<span class="math inline">\(E(XY), E(X)E(Y)\)</span>。 <span class="math display">\[E(XY) = E(ZX^2) = E(Z)E(X^2)\]</span> 其中，<span class="math inline">\(E(Z) = 1\times \cfrac{1}{2}+ (-1) \times \cfrac{1}{2} = 0\)</span>，故<span class="math inline">\(E(XY) = 0\)</span>。</p><p>而<span class="math inline">\(X, Y\)</span>都是<span class="math inline">\(m=0, \sigma^2 = 1\)</span>的高斯分布，故<span class="math inline">\(E(X) = E(Y) = 0\)</span></p><p>故<span class="math inline">\(E(XY) = E(X)E(Y)\)</span>，<span class="math inline">\(X,Y\)</span>不相关。</p></li><li><p><span class="math inline">\(X,Y\)</span>独立吗？ <span class="math inline">\(Y =ZX\)</span>欸，怎么可能独立？显然不独立啊！</p></li></ol><p>所以，即使<span class="math inline">\(X,Y\)</span>都是高斯的，其不相关仍然不能推导出独立。</p><p>怎样的条件下，独立和不相关才能是等价的呢？答案是联合高斯分布，即<span class="math display">\[X,Y:\ \left.\begin{array}{rcl}\text{joint Gaussian} \\\text{uncorrelated}\end{array}\right\}\Rightarrow \text{independent}\]</span> 一般地，如果多维随机变量<span class="math inline">\(\mathbb{X}= (X_1, X_2, \cdots, X_n)^\mathrm{T}\in\mathbb{R}^n\)</span>是<strong>联合高斯分布</strong>的，那么<span class="math inline">\(\mathbb{X}\)</span>各分量<strong>不相关<span class="math inline">\(\Leftrightarrow\)</span>独立</strong>。</p><p>下面给出二维<span class="math inline">\(n=2\)</span>情况下的证明。</p><p><strong>必要性<span class="math inline">\(\Leftarrow\)</span></strong>不需要多说，这是显然的。</p><p>只需要证明<strong>充分性<span class="math inline">\(\Rightarrow\)</span></strong></p><p>要说明独立性，首先计算<span class="math inline">\(\mathbb{X} =\left(X_1, X_2\right)^\mathrm{T}\)</span>的联合密度分布函数 <span class="math display">\[f_\mathbb{X}(x_1,x_2) = \cfrac{1}{2\pi\sigma_1\sigma_2\sqrt{1-\rho^2}}\exp\left(-\cfrac{1}{2(1-\rho^2)}\left( \cfrac{(x_1-\mu_1)^2}{\sigma_1^2} - \cfrac{2\rho(x_1 - \mu_1)(x_2 - \mu_2)}{\sigma_1 \sigma_2} +\cfrac{(x_2-\mu_2)^2}{\sigma_2 ^2} \right) \right)\]</span> 其中，<span class="math inline">\(\mu_k,\sigma_k\)</span>是<span class="math inline">\(X_k\)</span>的均值和方差<span class="math inline">\((k=1,2)\)</span>，<span class="math inline">\(\rho= E\left( (X_1-\mu_1)(X_2-\mu_2) \right)\)</span>。</p><p>现在我们来看<span class="math inline">\(\exp\)</span>指数上的交叉项：<span class="math display">\[\begin{equation*}\begin{aligned}\rho &amp; = E\left( (X_1-\mu_1)(X_2-\mu_2) \right) \\&amp; = E(X_1X_2) - E(X_1)\mu_2 - E(X_2)\mu_1 + \mu_1\mu_2 \\&amp; = E(X_1X_2) - \mu_1\mu_2\end{aligned}\end{equation*}\]</span> 由已知条件，<span class="math inline">\(X_1,X_2\)</span>不相关，即<span class="math inline">\(E(X_1X_2) = E(X_1)E(X_2) =\mu_1\mu_2\)</span>，故<span class="math inline">\(\rho =0\)</span>。因此有 <span class="math display">\[\begin{equation*}\begin{aligned}f_\mathbb{X}(x_1,x_2) &amp; =\cfrac{1}{2\pi\sigma_1\sigma_2\sqrt{1-\rho^2}}\exp\left(-\cfrac{1}{2(1-\rho^2)}\left( \cfrac{(x_1-\mu_1)^2}{\sigma_1^2} - \cfrac{2\rho(x_1 - \mu_1)(x_2 - \mu_2)}{\sigma_1 \sigma_2} +\cfrac{(x_2-\mu_2)^2}{\sigma_2 ^2} \right) \right)\\&amp; = \cfrac{1}{2\pi\sigma_1\sigma_2} \exp\left(-\cfrac{1}{2}\left(\cfrac{(x_1-\mu_1)^2}{\sigma_1 ^2} + \cfrac{(x_2-\mu_2)^2}{\sigma_2 ^2}\right) \right)\\&amp; = \cfrac{1}{\sqrt{2\pi}\sigma_1}\exp\left(-\cfrac{1}{2}\cfrac{(x_1-\mu_1)^2}{\sigma_1 ^2}\right) \cdot\cfrac{1}{\sqrt{2\pi}\sigma_2}\exp\left(-\cfrac{1}{2}\cfrac{(x_2-\mu_2)^2}{\sigma_2 ^2}\right)\\&amp; = f_{X_1}(x_1)\cdot f_{X_2}(x_2)\end{aligned}\end{equation*}\]</span> 即<span class="math inline">\(X_1,X_2\)</span>相互独立。至此，二维<span class="math inline">\(n=2\)</span>情况下，随机变量<span class="math inline">\(\mathbb{X} = (X_1, X_2)^\mathrm{T}\in\mathbb{R}^n\)</span>是联合高斯分布的，那么<span class="math inline">\(\mathbb{X}\)</span>各分量<span class="math inline">\(X_1,X_2\)</span>不相关与独立的等价性便证明出来了。</p><p>还有一个比较显然的结论：</p><p>给定一多元随机变量<span class="math inline">\(\mathbb{X} = \left(X_1,X_2, \cdots , X_n\right)^\mathrm{T} \in\mathbb{R}^n\)</span>，如果其各分量独立，且都服从高斯分布，则<span class="math inline">\(\mathbb{X}\)</span>是服从联合高斯分布的。</p><blockquote><p>这个结论过于显而易见了，这里不需要给出证明。</p></blockquote><h2 id="cochran-定理">Cochran 定理</h2><p>设一多维随机变量<span class="math inline">\(\mathbb{X} = \left(X_1,X_2, \cdots , X_n\right)^\mathrm{T} \in\mathbb{R}^n\)</span>。定义样本均值(sample mean) <span class="math display">\[\bar{X} = \cfrac{1}{n}\sum_{k=1}^{n} X_k\]</span> 和样本方差<span class="math inline">\(\bar{S^2}\)</span>(sample variance) <span class="math display">\[\bar{S^2} = \cfrac{1}{n-1}\sum_{k=1}^{n}\left( X_k-  \cfrac{1}{n}\sum_{k=1}^{n} X_k \right)^2\]</span></p><blockquote><p>假设每一个<span class="math inline">\(X_k\)</span>都有相同的均值和方差，则有<span class="math inline">\(E(\bar{X}) = E(X_k),\ E(\bar{S^2}) =var(X_K)\)</span>。至于这里前面的分母为什么是<span class="math inline">\(n-1\)</span>而不是<span class="math inline">\(n\)</span>，将在附章中说明。</p><p>补充说明一点，不妨设<span class="math inline">\(E(\mathbb{X}) =E\left(\cfrac{1}{n}\sum_{k=1}^{n} X_k\right) = E(X_1)\)</span>。</p><p>假设<span class="math inline">\(X_k = A + N_k\)</span>，其中<span class="math inline">\(A\)</span>是实际值，<span class="math inline">\(N_k\)</span>是噪声，有<span class="math inline">\(E(X_k)=A\)</span>。</p><p><span class="math display">\[\begin{equation*}\begin{aligned}var(\mathbb{X}) &amp; = E\left(\left(\cfrac{1}{n} \sum_{k=1}^n (X_k -A)\right)^2\right) \\&amp; = \cfrac{1}{n^2} E\left(\left(\sum_{k=1}^n (X_k -A)\right)^2\right) \\&amp; = \cfrac{1}{n^2} \left(\sum_{k=1}^nE\left( (X_k - A)^2\right) +\sum_{i \neq j}E\left( (X_i-A)(X_j-A)\right)\right)\end{aligned}\end{equation*}\]</span></p><p>其中，由于<span class="math inline">\(X_k\)</span>之间独立同分布，故交叉项<span class="math inline">\(E((X_i - A)(X_j - A)) = 0, \forall i \neqj\)</span>。所以 <span class="math display">\[\begin{equation*}\begin{aligned}var(\mathbb{X}) &amp; = \cfrac{1}{n^2} \sum_{k=1}^nE\left( (X_k -A)^2\right) \\&amp; = \cfrac{1}{n^2} n E\left( (X_1 - A)^2\right) \\&amp; = \cfrac{1}{n}var(X_1)\end{aligned}\end{equation*}\]</span></p><p>于是可以看出，在每次试验结果独立同分布的前提下，多次试验取平均可以使得结果方差有所下降。</p></blockquote><p><strong>Cochran定理</strong>是指，如果，且<span class="math inline">\(\mathbb{X}\)</span>各分类独立同分布，且服从高斯分布，则<span class="math inline">\(\bar{X}, \bar{S^2}\)</span>是独立的。</p><p>证明：</p><p>构造一个矩阵 <span class="math display">\[Q = \left[\begin{array}{}\cfrac{1}{\sqrt{n}} &amp; \cfrac{1}{\sqrt{n}} &amp; \cdots &amp;\cfrac{1}{\sqrt{n}} \\\text{*} &amp; \text{*} &amp; \cdots &amp; \text{*} \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\\text{*} &amp; \text{*} &amp; \cdots &amp; \text{*}\end{array}\right]_{(n\times n)}\]</span></p><p>这里<span class="math inline">\(Q\)</span>第一行确定，且满足<span class="math inline">\(Q\)</span>是正交的<span class="math inline">\(QQ^\mathrm{T} = I\)</span>。将<span class="math inline">\(Q\)</span>作用于<span class="math inline">\(\mathbb{X}\)</span> <span class="math display">\[\mathbb{Y} = Q\mathbb{X} = \left[\begin{array}{}\cfrac{1}{\sqrt{n}}\sum_{k=1}^n X_k \\\text{*} \\\vdots\\\text{*}\end{array}\right]\]</span></p><ol type="1"><li><p>由高斯线性性质，<span class="math inline">\(\mathbb{Y} \simN(Q\mu, Q\Sigma Q^\mathrm{T})\)</span></p></li><li><p>计算<span class="math inline">\(\bar{S^2}\)</span> <span class="math display">\[\begin{equation*}\begin{aligned}\sum_{k=1}^{n}\left( X_k -  \cfrac{1}{n}\sum_{k=1}^{n} X_k \right)^2&amp; = \sum_{k=1}^{n}\left( X_k -  \bar{X} \right)^2 \\&amp; = \sum_{k=1}^{n}\left( X_k ^ 2- 2X_k\bar{X} + \bar{X}^2\right) \\&amp; = \sum_{k=1}^{n}X_k ^ 2- 2\bar{X}\sum_{k=1}^{n}X_k + n\bar{X}^2 \\&amp; = \sum_{k=1}^{n}X_k ^ 2-  n\bar{X}^2\end{aligned}\end{equation*}\]</span> 由于<span class="math inline">\(Q\)</span>正交，<span class="math inline">\(Y=QX\)</span>，故<span class="math inline">\(Y^{\mathrm{T}} Y = X^{\mathrm{T}} Q^{\mathrm{T}} QX = X^{\mathrm{T}} X\)</span>。于是，(2.)中， <span class="math display">\[\begin{equation*}\begin{aligned}\sum_{k=1}^{n}\left( X_k -  \cfrac{1}{n}\sum_{k=1}^{n} X_k \right)^2&amp; = \sum_{k=1}^{n}X_k ^ 2-  n\bar{X}^2 \\&amp; = \sum_{k=1}^{n}Y_k ^ 2-  n\bar{X}^2 \\&amp; = \left(\cfrac{1}{\sqrt{n}}\sum_{k=1}^n X_k\right)^2 +\sum_{k=2}^{n}Y_k ^ 2-  n\bar{X}^2 \\&amp; = \cfrac{1}{n} (n\bar{X})^2 +  \sum_{k=2}^{n}Y_k ^ 2-  n\bar{X}^2\\&amp; = \sum_{k=2}^{n}Y_k ^ 2\end{aligned}\end{equation*}\]</span> 故 <span class="math display">\[\bar{S^2} = \cfrac{1}{n-1} \sum_{k=2}^{n}Y_k ^ 2\]</span></p></li><li><p>计算<span class="math inline">\(\bar{X}\)</span>根本就不用计算了。 <span class="math display">\[\bar{X} =\cfrac{1}{\sqrt{n}} Y_1\]</span></p></li></ol><p>至此，可以看出，<span class="math inline">\(\bar{X}\)</span>是取决于<span class="math inline">\(Y_1\)</span>的，而<span class="math inline">\(\bar{S^2}\)</span>是取决于<span class="math inline">\(Y_2, Y_3, \cdots, Y_n\)</span>的，故<span class="math inline">\(\mathbb{X}\)</span>的样本均值和样本方差是独立的。</p><h2 id="条件分布condition-distribution">条件分布(ConditionDistribution)</h2><p>设<span class="math inline">\(\mathbb{X} = \left[ \begin{array}{}\mathbb{X}_1 \\ \mathbb{X}_2 \end{array} \right]\in\mathbb{R}^{m+n}\)</span>，其中<span class="math inline">\(\mathbb{X}_1\in \mathbb{R}^m, \mathbb{X}_2 \in \mathbb{R}^n\)</span>。 <span class="math display">\[\mathbb{X} \sim N \left(\left(\begin{array}{}\mu_1 \\ \mu_2\end{array}\right),\left(\begin{array}{}\Sigma_{11} &amp; \Sigma_{12}\\\Sigma_{21} &amp; \Sigma_{22}\end{array}\right)\right)\]</span> 其中<span class="math inline">\(\mu_k,\Sigma_{kl}\)</span>相应的均值和协方差矩阵。</p><p>那么在条件<span class="math inline">\(\mathbb{X}_2\)</span>的约束下，<span class="math inline">\(\mathbb{X}_1\)</span>的分布如何？</p><p>写出条件概率密度分布函数 <span class="math display">\[f_{\mathbb{X}_1|\mathbb{X}_2}(x_1|x_2) =\cfrac{f_{\mathbb{X}_1,\mathbb{X}_2}(x_1, x_2)}{f_{\mathbb{X}_2}(x_2)} =\cfrac{c_1\exp\left(-\cfrac{1}{2}\left(\begin{array}{}x_1^\mathrm{T} - \mu_1^\mathrm{T} &amp; x_2^\mathrm{T} -\mu_2^\mathrm{T}\end{array}\right)\left(\begin{array}{}\Sigma_{11} &amp; \Sigma_{12}\\\Sigma_{21} &amp; \Sigma_{22}\end{array}\right)^{-1}\left(\begin{array}{}x_1 - \mu_1 \\ x_2 - \mu_2\end{array}\right)\right)}{c_2\exp\left(-\cfrac{1}{2}\left(\begin{array}{}x_2^\mathrm{T} - \mu_2^\mathrm{T}\end{array}\right)\Sigma_{22}^{-1}\left(\begin{array}{}x_2 - \mu_2\end{array}\right)\right)}\]</span></p><p>忽略常数项，指数部分是 <span class="math display">\[-\cfrac{1}{2}\left(\begin{array}{}x_1^\mathrm{T} - \mu_1^\mathrm{T} &amp; x_2^\mathrm{T} -\mu_2^\mathrm{T}\end{array}\right)\left(\begin{array}{}\Sigma_{11} &amp; \Sigma_{12}\\\Sigma_{21} &amp; \Sigma_{22}\end{array}\right)^{-1}\left(\begin{array}{}x_1 - \mu_1 \\ x_2 - \mu_2\end{array}\right)+\cfrac{1}{2}\left(\begin{array}{}x_2^\mathrm{T} - \mu_2^\mathrm{T}\end{array}\right)\Sigma_{22}^{-1}\left(\begin{array}{}x_2 - \mu_2\end{array}\right)\]</span> 这里比较棘手的部分是<span class="math inline">\(\left(\begin{array}{} \Sigma_{11} &amp; \Sigma_{12}\\ \Sigma_{21} &amp;\Sigma_{22} \end{array}\right)^{-1}\)</span>，要求出这个逆，最好把原矩阵对角化 <span class="math display">\[\left(\begin{array}{}I &amp; -\Sigma_{12}\Sigma_{22}^{-1}\\0 &amp; I\end{array}\right)\left(\begin{array}{}\Sigma_{11} &amp; \Sigma_{12}\\\Sigma_{21} &amp; \Sigma_{22}\end{array}\right)\left(\begin{array}{}I &amp; 0\\-\Sigma_{22}^{-1}\Sigma_{21} &amp; I\end{array}\right) =\left(\begin{array}{}\Sigma_{11} - \Sigma_{12}\Sigma_{22}^{-1}\Sigma_{21} &amp; 0\\0 &amp; \Sigma_{22}\end{array}\right)\]</span></p><p>故 <span class="math display">\[\left(\begin{array}{}\Sigma_{11} &amp; \Sigma_{12}\\\Sigma_{21} &amp; \Sigma_{22}\end{array} \right) ^ {-1} =\left(\begin{array}{}I &amp; 0\\-\Sigma_{22}^{-1}\Sigma_{21} &amp; I\end{array}\right)\left(\begin{array}{}\Sigma_{11} - \Sigma_{12}\Sigma_{22}^{-1}\Sigma_{21} &amp; 0\\0 &amp; \Sigma_{22}\end{array}\right)^{-1}\left(\begin{array}{}I &amp; -\Sigma_{12}\Sigma_{22}^{-1}\\0 &amp; I\end{array}\right)\]</span> 进一步地， <span class="math display">\[\begin{equation*}\begin{aligned}&amp;\left(\begin{array}{}x_1^\mathrm{T} - \mu_1^\mathrm{T} &amp; x_2^\mathrm{T} -\mu_2^\mathrm{T}\end{array}\right)\left(\begin{array}{}\Sigma_{11} &amp; \Sigma_{12}\\\Sigma_{21} &amp; \Sigma_{22}\end{array}\right)^{-1}\left(\begin{array}{}x_1 - \mu_1 \\ x_2 - \mu_2\end{array}\right)\\=&amp;\left(\begin{array}{}x_1^\mathrm{T} - \mu_1^\mathrm{T} &amp; x_2^\mathrm{T} -\mu_2^\mathrm{T}\end{array}\right)\left(\begin{array}{}I &amp; 0\\-\Sigma_{22}^{-1}\Sigma_{21} &amp; I\end{array}\right)\left(\begin{array}{}\Sigma_{11} - \Sigma_{12}\Sigma_{22}^{-1}\Sigma_{21} &amp; 0\\0 &amp; \Sigma_{22}\end{array}\right)^{-1}\left(\begin{array}{}I &amp; -\Sigma_{12}\Sigma_{22}^{-1}\\0 &amp; I\end{array}\right)\left(\begin{array}{}x_1 - \mu_1 \\ x_2 - \mu_2\end{array}\right)\\= &amp;\left(x_1^{\mathrm{T}} - \mu_1^{\mathrm{T}} - (x_2^{\mathrm{T}} -\mu_2^{\mathrm{T}}) \Sigma_{22}^{-1}\Sigma_{21}\right)\left(\Sigma_{11} - \Sigma_{12}\Sigma_{22}^{-1}\Sigma_{21}\right)^{-1}\left(x_1 - \mu_1 - \Sigma_{12}\Sigma_{22}^{-1} (x_2 - \mu_2)\right) \\&amp; + (x_2^{\mathrm{T}} - \mu_2^{\mathrm{T}})\Sigma_{22}^{-1} (x_2 -\mu_2)\end{aligned}\end{equation*}\]</span> 故指数部分 <span class="math display">\[\begin{equation*}\begin{aligned}&amp;-\cfrac{1}{2}\left(\begin{array}{}x_1^\mathrm{T} - \mu_1^\mathrm{T} &amp; x_2^\mathrm{T} -\mu_2^\mathrm{T}\end{array}\right)\left(\begin{array}{}\Sigma_{11} &amp; \Sigma_{12}\\\Sigma_{21} &amp; \Sigma_{22}\end{array}\right)^{-1}\left(\begin{array}{}x_1 - \mu_1 \\ x_2 - \mu_2\end{array}\right)+\cfrac{1}{2}\left(\begin{array}{}x_2^\mathrm{T} - \mu_2^\mathrm{T}\end{array}\right)\Sigma_{22}^{-1}\left(\begin{array}{}x_2 - \mu_2\end{array}\right)\\=&amp;-\cfrac{1}{2}\left(x_1^{\mathrm{T}} - \mu_1^{\mathrm{T}} - (x_2^{\mathrm{T}} -\mu_2^{\mathrm{T}}) \Sigma_{22}^{-1}\Sigma_{21}\right)\left(\Sigma_{11} - \Sigma_{12}\Sigma_{22}^{-1}\Sigma_{21}\right)^{-1}\left(x_1 - \mu_1 - \Sigma_{12}\Sigma_{22}^{-1} (x_2 - \mu_2)\right)\\=&amp;-\cfrac{1}{2}\left(x_1 - \mu_{1|2}\right)^{\mathrm{T}}\Sigma_{1|2}^{-1}\left(x_1 - \mu_{1|2}\right)\end{aligned}\end{equation*}\]</span> 即 <span class="math display">\[f_{\mathbb{X}_1|\mathbb{X}_2}(x_1|x_2) =\cfrac{f_{\mathbb{X}_1,\mathbb{X}_2}(x_1, x_2)}{f_{\mathbb{X}_2}(x_2)} =c\exp\left( -\cfrac{1}{2}\left(x_1 - \mu_{1|2}\right)^{\mathrm{T}}\Sigma_{1|2}^{-1}\left(x_1 - \mu_{1|2}\right)\right)\]</span> 其中 <span class="math display">\[c=\cfrac{c_1}{c_2}, \\\mu_{1|2} = \mu_1 + \Sigma_{12}\Sigma_{22}^{-1} (x_2 - \mu_2) =E(X_1|X_2),\\\Sigma_{1|2} = \Sigma_{11} - \Sigma_{12}\Sigma_{22}^{-1}\Sigma_{21}\]</span></p><p>现在我们来看看这有什么含义。</p><ol type="1"><li><p>常数项<span class="math inline">\(c\)</span>不用说了。</p></li><li><p><span class="math inline">\(\mu_{1|2} = \mu_1 +\Sigma_{12}\Sigma_{22}^{-1} (x_2 - \mu_2) =E(X_1|X_2)\)</span>指的是，本来在没有已知条件的情况下，对<span class="math inline">\(X_1\)</span>的期望估计就是纯纯的<span class="math inline">\(\mu_1\)</span>，现加入估计<span class="math inline">\(X_2\)</span>，代表我们有一定的先验信息，那么第二项<span class="math inline">\(\Sigma_{12}\Sigma_{22}^{-1} (x_2 - \mu_2) =E(X_1|X_2)\)</span>代表的是这一信息对<span class="math inline">\(\mu_1\)</span>的调整，其可以认为是随机变量<span class="math inline">\(X_1\)</span>在<span class="math inline">\(X_2\)</span>方向的投影。<span class="math inline">\(\Sigma_{12}\Sigma_{22}^{-1}\)</span>则可以认为是两个随机变量的夹角，意味着两个随机变量的相关，如果这个相关性越强，那么先验信息<span class="math inline">\(X_2\)</span>对结果的影响就越大。在高斯分布的前提下，这样的调整实际上是一种最优的调整。下面我们来说明其为何最优。现在我们有先验信息<span class="math inline">\(X_2\)</span>，我们要估计在这样的先验信息下<span class="math inline">\(X_1\)</span>的最优估计。为简化计算，我们假设它们都是均值为<span class="math inline">\(0\)</span>的高斯分布。</p><ul><li><p>最优线性估计<span class="math inline">\(X_1\leftarrowX_2\)</span> <span class="math display">\[\min_\alpha E\left((X_1 - \alpha X_2)^2\right)\]</span> 得到的<span class="math inline">\(\alpha =\cfrac{E(X_1X_2)}{E(X_2^2)}\)</span>就是投影。这里不用证明了，各个学科都证明太多次了。</p></li><li><p>最优估计<span class="math inline">\(X_1\leftarrow X_2\)</span><span class="math display">\[\min_gE\left( (X_1 - g(X_2))^2 \right)\]</span>实际上，在高斯分布的前提下，上面的最优线性估计就是最优估计了，即<span class="math inline">\(g\)</span>就是概率期望函数，<span class="math inline">\(g(X_2) = E(X_1|X_2)\)</span>。这是因为 <span class="math display">\[\begin{equation*}\begin{aligned}E\left( (X_1 - g(X_2))^2 \right) &amp; = E\left( (X_1 -E(X_1|X_2) +E(X_1|X_2) - g(X_2))^2 \right) \\&amp; = E\left( ((X_1 -E(X_1|X_2))^2 \right) + E\left((E(X_1|X_2) -g(X_2))^2 \right)\\&amp; + 2E\left( (X_1 -E(X_1|X_2)) (E(X_1|X_2) - g(X_2)) \right)\end{aligned}\end{equation*}\]</span> 得到的第三项 <span class="math display">\[E\left( (X_1 -E(X_1|X_2)) (E(X_1|X_2) - g(X_2)) \right) = E_{X_2}\left(E_{X_1}\left(  (X_1 - E(X_1|X_2) ) ( E(X_1|X_2) - g(X_2) ) |X_2\right)\right)\]</span> 其中 <span class="math display">\[\begin{equation*}\begin{aligned}E_{X_1}\left((X_1 - E(X_1|X_2) ) ( E(X_1|X_2) - g(X_2) )|X_2 \right) &amp; = ( E(X_1|X_2) - g(X_2) )E_{X_1}\left((X_1 -E(X_1|X_2) ) |X_2 \right) \\&amp; = ( E(X_1|X_2) - g(X_2) )(E(X_1 |X_2) - E(X_1|X_2) )\\&amp; = 0\end{aligned}\end{equation*}\]</span> 这意味着， <span class="math display">\[E\left( (X_1 - g(X_2))^2 \right) = E\left( ((X_1 -E(X_1|X_2))^2 \right)+ E\left((E(X_1|X_2) - g(X_2))^2 \right)\]</span> 而第二项作为平方项的期望是非负的，故对于任意的<span class="math inline">\(g\)</span>，都有 <span class="math display">\[E\left( (X_1 - g(X_2))^2 \right) \geq E\left( ((X_1 -E(X_1|X_2))^2\right)\]</span> 至此，上面的结论得证了。</p></li></ul></li><li><p><span class="math inline">\(\Sigma_{1|2} = \Sigma_{11} -\Sigma_{12}\Sigma_{22}^{-1}\Sigma_{21}\)</span>表示的是加入先验信息后新估计的协方差矩阵，是大于零（正定）的。这是显然的，因为是协方差矩阵嘛，不过同时这可以直接从Cauthy-Schwarz不等式直接导出。另外不难看出第二项也是正定的，也就是说，新的协方差矩阵一定会比有先验信息之前的<span class="math inline">\(\Sigma_{11}\)</span>更小。从信息的角度上来讲，这是因为引入先验信息后，随机变量的熵一定是减小的，这也是符合直觉的。</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 学习笔记：随机过程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数学 </tag>
            
            <tag> 随机过程 </tag>
            
            <tag> 高斯过程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>误差理论：协方差传播定律</title>
      <link href="/2022/06/09/%E5%8D%8F%E6%96%B9%E5%B7%AE%E4%BC%A0%E6%92%AD%E5%AE%9A%E5%BE%8B/"/>
      <url>/2022/06/09/%E5%8D%8F%E6%96%B9%E5%B7%AE%E4%BC%A0%E6%92%AD%E5%AE%9A%E5%BE%8B/</url>
      
        <content type="html"><![CDATA[<p>在实际工作中，往往会遇到某些量的大小并不是直接测定的，而是由观测值通过一定的函数关系间接计算出来的。那么，观测值的函数的中误差与观测值的中误差之间存在着怎样的关系？实际上，这样的关系可以通过协方差的运算规则得到，因此被称作<strong>协方差传播定律</strong>，又称误差传播定率。<span id="more"></span></p><h1 id="观测值线性函数的方差">观测值线性函数的方差</h1><p>设有观测值<span class="math inline">\(X\in\mathbb{R}^n\)</span>，其均值为<span class="math inline">\(\mu_X\in\mathbb{R}^n\)</span>，协方差矩阵为<span class="math inline">\(\Sigma_{XX}\in\mathbb{R}^{n\timesn}\)</span>，又设有<span class="math inline">\(X\)</span>的线性函数<span class="math display">\[Z = K^{\mathrm{T}}X+k_0\]</span> 其中<span class="math inline">\(Z\in\mathbb{R}\)</span>，<span class="math inline">\(K\in\mathbb{R}^n\)</span>是常量，<span class="math inline">\(k_0\)</span>是常数。</p><p>现求<span class="math inline">\(Z\)</span>的方差<span class="math inline">\(\sigma_Z^2\in\mathbb{R}\)</span>。</p><p>根据上述的线性关系，可求得 <span class="math display">\[\begin{eqnarray}E(Z) &amp; = &amp; E(K^\mathrm{T}X+k_0) \\&amp; = &amp; K^{\mathrm{T}} E(X) + k_0 \\&amp; = &amp; K^{\mathrm{T}} \mu_X + k_0\end{eqnarray}\]</span> 于是， <span class="math display">\[\begin{eqnarray}\sigma_Z^2 &amp; = &amp; E((Z - E(Z))^2) \\&amp; = &amp; E((K^{\mathrm{T}}X + k_0 - K^{\mathrm{T}} \mu_X - k_0)^2)\\&amp; = &amp; E((K^{\mathrm{T}}X- K^{\mathrm{T}} \mu_X)(K^{\mathrm{T}}X- K^{\mathrm{T}} \mu_X)^{\mathrm{T}}) \\&amp; = &amp; K^{\mathrm{T}} E((X - \mu_X)(X - \mu_X)^{\mathrm{T}}) K \\&amp; = &amp; K^{\mathrm{T}} \Sigma_{XX} K\end{eqnarray}\]</span> 即 <span class="math display">\[\sigma_Z^2 =  K^{\mathrm{T}} \Sigma_{XX} K\]</span> 上式就是<strong>协方差传播定律</strong>。当<span class="math inline">\(X\)</span>各分量线性无关时，<span class="math inline">\(\Sigma_{XX}\)</span>是对角的，即 <span class="math display">\[\left( \Sigma_{XX} \right)_{ij} = \left\{\begin{eqnarray}\sigma_i^2, &amp; \; &amp;i=j \\\\0,&amp; \; &amp; i\neq j\end{eqnarray}\right.\]</span> 此时<span class="math inline">\(\sigma_Z^2\)</span>可以表示为<span class="math inline">\(X\)</span>各分量方差的加权和： <span class="math display">\[\begin{eqnarray}\sigma_Z^2 &amp; = &amp; k_1^2 \sigma_1^2 + k_2^2 \sigma_2^2 + \cdots +k_n^2 \sigma_n^2 \\&amp; = &amp; \sum_{i=1}^n k_i^2 \sigma_i^2\end{eqnarray}\]</span></p><h1 id="多个观测值线性函数的协方差矩阵">多个观测值线性函数的协方差矩阵</h1><p>设有观测值<span class="math inline">\(X\in\mathbb{R}^n\)</span>，其均值为<span class="math inline">\(\mu_X\in\mathbb{R}^n\)</span>，协方差矩阵为<span class="math inline">\(\Sigma_{XX}\in\mathbb{R}^{n\timesn}\)</span>，又设有<span class="math inline">\(X\)</span>的<span class="math inline">\(t\)</span>个线性函数 <span class="math display">\[\begin{eqnarray}Z_1 &amp; = &amp; k_{11}X_1 + k_{12}X_2 + k_{1n}X_n + k_{10} \\Z_2 &amp; = &amp; k_{21}X_1 + k_{22}X_2 + k_{2n}X_n + k_{20} \\&amp; \cdots &amp;  \\Z_t &amp; = &amp; k_{t1}X_1 + k_{t2}X_2 + k_{tn}X_n + k_{t0}\end{eqnarray}\]</span> 令<span class="math inline">\(Z = (Z_1, Z_2,\cdots,Z_t)^\mathrm{T}\)</span>，则上式可写作 <span class="math display">\[Z = K^\mathrm{T}X + K_0^\mathrm{T}\]</span> 其中， <span class="math display">\[K^\mathrm{T} = \left(\begin{array}{}k_{11} &amp; k_{12} &amp; \cdots &amp; k_{1n} \\k_{21} &amp; k_{22} &amp; \cdots &amp; k_{2n} \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\k_{t1} &amp; k_{t2} &amp; \cdots &amp; k_{tn} \\\end{array}\right)\in \mathbb{R}^{t\times n}, \\K_0^\mathrm{T} = \left( k_{10},\ k_{20},\ \cdots,\ k_{t0}\right)^\mathrm{T} \in \mathbb{R}^t\]</span> 按照上一节中的推导，<span class="math inline">\(Z\)</span>的协方差矩阵为 <span class="math display">\[\Sigma_{ZZ} = K^\mathrm{T} \Sigma_{XX} K^\mathrm{T}\]</span>这与上一节得到的协方差具有一致的形式。实际上，该式是协方差传播定律的一般形式。</p><h1 id="非线性函数的情况">非线性函数的情况</h1><p>设有观测值<span class="math inline">\(X\)</span>的非线性函数 <span class="math display">\[Z = f(X) = f(X_1, X_2, \cdots, X_n)\]</span> 已知观测值<span class="math inline">\(X\)</span>的近似值<span class="math inline">\(X^0 = (X_1^0, X_2^0, \cdots,X_n^0)^\mathrm{T}\)</span>和<span class="math inline">\(X\)</span>的协方差矩阵<span class="math inline">\(\Sigma_{XX}\)</span>，现求<span class="math inline">\(Z\)</span>的方差<span class="math inline">\(\sigma_Z^2\)</span>。</p><p>利用泰勒展开将<span class="math inline">\(f(X)\)</span>在<span class="math inline">\(X^0\)</span>处线性化：将其在<span class="math inline">\(X^0\)</span>处展开 <span class="math display">\[Z = f(X_1^0, X_2^0, \cdots, X_n^0) + \left.\cfrac{\partial f}{\partialX_1}\right|_0 (X_1 - X_1^0) + \left.\cfrac{\partial f}{\partialX_2}\right|_0 (X_2 - X_2^0) + \cdots + \left.\cfrac{\partial f}{\partialX_n}\right|_0 (X_n - X_n^0) + o(X-X^0)\]</span> 由于<span class="math inline">\(X^0\)</span>是对<span class="math inline">\(X\)</span>的近似估计，因此可以认为其差的高阶项是小量，故忽略之，于是上式可写为<span class="math display">\[Z = \left.\cfrac{\partial f}{\partial X_1}\right|_0 X_1 +\left.\cfrac{\partial f}{\partial X_2}\right|_0 X_2 + \cdots +\left.\cfrac{\partial f}{\partial X_n}\right|_0 X_n + f(X_1^0, X_2^0,\cdots, X_n^0) - \sum_{i=1}^{n} \left.\cfrac{\partial f}{\partialX_i}\right|_0 X_i^0\]</span> 令 <span class="math display">\[\begin{eqnarray}K^\mathrm{T} = \left[\begin{array}{}k_1 &amp; k_2 &amp; \cdots\ &amp; k_n\end{array}\right]=\left[\begin{array}{}\left.\cfrac{\partial f}{\partial X_1}\right|_0 &amp;\left.\cfrac{\partial f}{\partial X_2}\right|_0 &amp; \cdots &amp;\left.\cfrac{\partial f}{\partial X_n}\right|_0\end{array}\right]\\k_0 = f(X_1^0, X_2^0, \cdots, X_n^0) - \sum_{i=1}^{n}\left.\cfrac{\partial f}{\partial X_i}\right|_0 X_i^0\end{eqnarray}\]</span> 那么<span class="math inline">\(Z\)</span>则表示为与第一节中一致的形式 <span class="math display">\[Z = K^\mathrm{T}X + k_0\]</span> 于是可以求得<span class="math inline">\(Z\)</span>的方差<span class="math inline">\(\sigma_Z^2\)</span>为 <span class="math display">\[\sigma_Z^2 = K^\mathrm{T} \Sigma_{XX} K\]</span> 类似地，如果有<span class="math inline">\(t\)</span>个非线性函数 <span class="math display">\[\begin{eqnarray}Z_1 &amp; = &amp; f_1(X_1, X_2, \cdots, X_n) \\Z_2 &amp; = &amp; f_2(X_1, X_2, \cdots, X_n) \\&amp; \cdots &amp; \\Z_t &amp; = &amp; f_t(X_1, X_2, \cdots, X_n) \\\end{eqnarray}\]</span> 此时</p><p><span class="math display">\[K^\mathrm{T} =\left[\begin{array}{}\left.\cfrac{\partial f_1}{\partial X_1}\right|_0 &amp;\left.\cfrac{\partial f_1}{\partial X_n}\right|_0 &amp; \cdots &amp;\left.\cfrac{\partial f_1}{\partial X_n}\right|_0 \\\left.\cfrac{\partial f_2}{\partial X_1}\right|_0 &amp;\left.\cfrac{\partial f_2}{\partial X_n}\right|_0 &amp; \cdots &amp;\left.\cfrac{\partial f_2}{\partial X_n}\right|_0 \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\\left.\cfrac{\partial f_t}{\partial X_1}\right|_0 &amp;\left.\cfrac{\partial f_t}{\partial X_n}\right|_0 &amp; \cdots &amp;\left.\cfrac{\partial f_t}{\partial X_n}\right|_0 \\\end{array}\right]\in \mathbb{R}^{t\times n}\]</span></p><p>进而有 <span class="math display">\[\Sigma_{ZZ} = K^\mathrm{T}\Sigma_{XX}K\]</span></p><h1 id="应用举例时间序列的最小二乘拟合">应用举例：时间序列的最小二乘拟合</h1><p>现考虑一个关于时间序列拟合的例子，使用普通最小二乘的方法拟合出一个时间序列线性趋势、三角周期的振幅和初始相位，即<span class="math inline">\(f(t) = a + bt + Asin(2\pi t +\phi)\)</span>，以及相应的标准差。</p><p>由于最小二乘解决问题须要模型是线性的，不能直接拟合模型中的<span class="math inline">\(A, \phi\)</span>及相应的标准差<span class="math inline">\(\sigma_A,\sigma_\phi\)</span>，因此我们考虑的模型应该是 <span class="math display">\[f(t) = a + bt + c\sin (2\pi t) + d\cos (2\pi t)\]</span> 进而计算振幅和初始相位 <span class="math display">\[\begin{eqnarray}A=\sqrt{c^2 + d^2} \\\phi = \arctan{\cfrac{d}{c}}\end{eqnarray}\]</span> 现已知最小二乘的结果 <span class="math display">\[\hat{f} (t) = \hat{a} + \hat{b}t + \hat{c}\sin (2\pi t) + \hat{d}\cos(2\pi t)\]</span> 协方差矩阵是 <span class="math display">\[\Sigma =\left[\begin{array}{}\sigma_a^2 &amp; \sigma_{ab} &amp; \sigma_{ac} &amp; \sigma_{ad} \\\sigma_{ba} &amp; \sigma_b^2 &amp; \sigma_{bc} &amp; \sigma_{bd} \\\sigma_{ca} &amp; \sigma_{cb} &amp; \sigma_c^2 &amp; \sigma_{cd} \\\sigma_{da} &amp; \sigma_{db} &amp; \sigma_{dc} &amp; \sigma_d^2\end{array}\right]\]</span> 其中<span class="math inline">\(\sigma_{ij} = \sigma_{ji},\i,j \in \set{a,b,c,d}\)</span>。</p><p>线性项及相应不确定度至此可以直接得到答案了。同时可以求得振幅和相位<span class="math inline">\(\hat{A}=\sqrt{\hat{c}^2 + \hat{d}^2},\ \hat{\phi}=\arctan{\cfrac{\hat{d}}{\hat{c}}}\)</span>，现在我们关注它们的标准差：</p><p><span class="math inline">\(A,\phi\)</span>都是<span class="math inline">\(c,d\)</span>的非线性函数，先求对应的矩阵<span class="math inline">\(K\)</span>：</p><p><span class="math display">\[K^\mathrm{T} =\left.\left[\begin{array}{}\cfrac{\partial A}{\partial c} &amp; \cfrac{\partial A}{\partial d} \\\cfrac{\partial \phi}{\partial c} &amp; \cfrac{\partial \phi}{\partiald}\end{array}\right] \right|_{(c=\hat{c}, d=\hat{d})}=\left[\begin{array}{}\cfrac{\hat{c}}{\sqrt{\hat{c}^2 + \hat{d}^2}} &amp;\cfrac{\hat{d}}{\sqrt{\hat{c}^2 + \hat{d}^2}} \\\cfrac{-\hat{d}}{\hat{c}^2 + \hat{d}^2} &amp; \cfrac{\hat{c}}{\hat{c}^2+ \hat{d}^2}\end{array}\right]\]</span></p><p>进一步可以求得</p><p><span class="math display">\[\begin{eqnarray}\Sigma_{A\phi} &amp; = &amp;\left[\begin{array}{}\sigma_{A}^2 &amp; \sigma_{A\phi} \\\sigma_{\phi A} &amp; \sigma_{\phi}^2\end{array}\right] \\&amp; = &amp; K^\mathrm{T} \Sigma_{cd} K \\&amp; = &amp; \left[\begin{array}{}\cfrac{\hat{c}}{\sqrt{\hat{c}^2 + \hat{d}^2}} &amp;\cfrac{\hat{d}}{\sqrt{\hat{c}^2 + \hat{d}^2}} \\\cfrac{-\hat{d}}{\hat{c}^2 + \hat{d}^2} &amp; \cfrac{\hat{c}}{\hat{c}^2+ \hat{d}^2}\end{array}\right]\left[\begin{array}{}\sigma_{c}^2 &amp; \sigma_{cd}\\\sigma_{dc} &amp; \sigma_{d}^2\end{array}\right]\left[\begin{array}{}\cfrac{\hat{c}}{\sqrt{\hat{c}^2 + \hat{d}^2}} &amp;\cfrac{-\hat{d}}{\hat{c}^2 + \hat{d}^2} \\\cfrac{\hat{d}}{\sqrt{\hat{c}^2 + \hat{d}^2}} &amp;\cfrac{\hat{c}}{\hat{c}^2 + \hat{d}^2}\end{array}\right] \\&amp; = &amp;\left[\begin{array}{}\cfrac{1}{\hat{c}^2 + \hat{d}^2} \left( \hat{c}^2 \sigma_c^2 +2\hat{c}\hat{d}\sigma_{cd} + \hat{d}^2 \sigma_d^2 \right) &amp; * \\* &amp; \cfrac{1}{\left(\hat{c}^2 + \hat{d}^2\right)^2 } \left(\hat{d}^2 \sigma_c^2 - 2\hat{c}\hat{d}\sigma_{cd} + \hat{c}^2\sigma_d^2\right)\end{array}\right]\end{eqnarray}\]</span></p><p>至此得到相应的方差，开方即得相应的标准差。</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记：误差理论 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数学 </tag>
            
            <tag> 误差理论 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>随机过程笔记：高斯过程(1)</title>
      <link href="/2022/06/07/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B1/"/>
      <url>/2022/06/07/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B1/</url>
      
        <content type="html"><![CDATA[<p>高斯过程是非常重要的一类随机过程，其应用在各领域都非常广泛。本文介绍了高斯过程的定义，并通过几个例子说明了高斯过程在不同学科领域的重要地位。本文属于随机过程笔记，根据清华大学电子工程系张颢副研究员的随机过程线上课程笔记整理而成，<a href="https://www.bilibili.com/video/BV1V44y1z7yi?share_source=copy_web">这是课程链接</a>。</p><span id="more"></span><h1 id="高斯过程的定义">高斯过程的定义</h1><p>对于随机过程<span class="math inline">\(X(t)\)</span>，如果有 <span class="math display">\[\forall n,\ \forall t_1\leq t_2\leq \cdots\leq t_n, \\s.t.\ \mathbb{X} =(X(t_1), X(t_2), \cdots,X(t_n))^\mathrm{T} \sim N(\mu, \Sigma)\]</span> 则称<span class="math inline">\(X(t)\)</span>是高斯过程。</p><p>举例：</p><ol type="1"><li><p><span class="math inline">\(n=1\)</span>时， <span class="math display">\[f_X(x) = \cfrac{1}{\sqrt{2\pi}\sigma}\exp\left(-\cfrac{(x-\mu)^2}{2\sigma ^2}\right)\]</span></p></li><li><p><span class="math inline">\(n=2\)</span>时， <span class="math display">\[f_\mathbb{X}(x_1,x_2) = \cfrac{1}{2\pi\sigma_1\sigma_2\sqrt{1-\rho^2}}\exp\left(-\cfrac{1}{2(1-\rho^2)}\left( \cfrac{(x_1-\mu_1)^2}{\sigma_1^2} - \cfrac{2\rho(x_1 - \mu_1)(x_2 - \mu_2)}{\sigma_1 \sigma_2} +\cfrac{(x_2-\mu_2)^2}{\sigma_2 ^2} \right) \right)\]</span> 其中，<span class="math inline">\(\mu_k,\sigma_k\)</span>是<span class="math inline">\(X_k\)</span>的均值和方差<span class="math inline">\((k=1,2)\)</span>，<span class="math inline">\(\rho= E\left( (X_1-\mu_1)(X_2-\mu_2) \right)\)</span>。</p></li><li><p>一般化的<span class="math inline">\(n\)</span>时，需要用到矩阵-向量的语言来描述问题：<span class="math display">\[f_\mathbb{X}(x) = \cfrac{1}{(2\pi) ^ \frac{n}{2} (\det\Sigma) ^\frac{1}{2}} \exp \left( -\cfrac{1}{2}(x-\mu)^\mathrm{T}\Sigma^{-1}(x-\mu) \right)\]</span> 其中，<span class="math inline">\(x,\mu \in\mathbb{R}^n\)</span>是<span class="math inline">\(n\)</span>维向量，<span class="math inline">\(\mu\)</span>代表均值；<span class="math inline">\(\Sigma \in \mathbb{R}^{n\timesn}\)</span>是协方差矩阵，<span class="math inline">\(\Sigma =E\left((x-\mu)(x-\mu)^\mathrm{T}\right)\)</span></p></li></ol><h1 id="高斯过程的意义">高斯过程的意义</h1><p>高斯过程是自然界中最为常见、最为普遍的一类随机过程。接下来将用三个例子说明其重要意义。</p><h2 id="中心极限定理central-limit-theorem-clt与大数定律law-of-large-numbers-lln">中心极限定理(CentralLimit Theorem, CLT)与大数定律(Law of Large Numbers, LLN)</h2><p><strong>中心极限定理</strong>表述为：</p><blockquote><p>有<span class="math inline">\(n\)</span>个独立同分布的随机变量<span class="math inline">\(X_1, X_2, \cdots,X_n\)</span>，假定他们均值和方差都是<span class="math inline">\(E(X_k) =0,\ Var(X_k) = 1\)</span>，那么当<span class="math inline">\(n\)</span>趋于<span class="math inline">\(\infty\)</span>时，这些随机变量之和与<span class="math inline">\(\sqrt{n}\)</span>的比值是趋于高斯分布的。即 <span class="math display">\[\lim_{n\rightarrow \infty} \cfrac{X_1 + X_2 + \cdots +X_n}{\sqrt{n}}\sim N(0,1)\]</span></p></blockquote><p>要验证这个定理，我们首先介绍一个非常常用的工具：<strong>特征函数</strong></p><blockquote><p>定义随机变量<span class="math inline">\(X\)</span>的特征函数 <span class="math display">\[\Phi_X(\omega) = E\left((\exp(i\omega X)\right)\]</span></p></blockquote><p>忽略系数而言，显然，特征函数<span class="math inline">\(\Phi_X(\omega) = E(\exp(i\omega X)) = \int_{-\infty}^{+\infty}\exp(i\omega x)f_X(x)\mathrm{d}x\)</span>是<span class="math inline">\(f_X\)</span>的傅里叶逆变换。因此，同分布的随机变量与其特征函数是一一对应的。同时，由于傅里叶变换的性质我们可以得到，由于<span class="math inline">\(f_X \geq 0\)</span>，特征函数<span class="math inline">\(\Phi_X\)</span>是正定的。</p><p>有了特征函数这样一个工具，我们可以来验证中心极限定理了。现有<span class="math inline">\(n\)</span>个独立同分布的随机变量<span class="math inline">\(X_1, X_2, \cdots,X_n\)</span>，假定他们均值和方差都是<span class="math inline">\(E(X_k) =0,\ Var(X_k) =1\)</span>（这里的假定只是为了简化后面的书写，并不影响该问题的本质），又有随机变量<span class="math inline">\(Y=X_1 + X_2 + \cdots + X_n =\sum_{k=1}^{n}X_k\)</span>，于是<span class="math inline">\(Y\)</span>的特征函数为</p><p><span class="math display">\[\begin{equation*}\begin{aligned}\Phi_Y(\omega)  &amp; =  E\left(\exp\left( i\omega Y \right)\right) \\&amp; = E\left(\exp\left( i\omega \sum_{k=1}^{n} X_k \right)\right) \\&amp; \overset{\text{(i.i.d)}}{=} E\left(\prod_{k=1}^{n} \exp\left(i\omega X_k \right) \right) \\&amp; = \prod_{k=1}^n \Phi_{X_k}\left(\omega \right) \\&amp; =  \left(\Phi_X(\omega)\right) ^n\end{aligned}\end{equation*}\]</span></p><p>其中，由于<span class="math inline">\(X_k,\k=1,2,\cdots,n\)</span>独立同分布，他们的特征函数一样，<span class="math inline">\(\Phi_{X_k}(\omega) = \Phi_X(\omega),\x=1,2,\cdots, n\)</span>，又有 <span class="math display">\[\begin{equation*}\begin{aligned}\Phi_{\frac{Y}{\sqrt{n}}}(\omega) &amp;  =  E\left(\exp\left( i\omega\cfrac{Y}{\sqrt{n}} \right)\right) \\&amp; =  E\left(\exp\left( i \cfrac{\omega}{\sqrt{n}} Y \right)\right)\\&amp; =  \Phi_Y \left(\cfrac{\omega}{\sqrt{n}} \right) \\&amp; =  \left(\Phi_X(\cfrac{\omega}{\sqrt{n}})\right) ^n\end{aligned}\end{equation*}\]</span> 其中 <span class="math display">\[\begin{equation*}\begin{aligned}\Phi_X(\cfrac{\omega}{\sqrt{n}}) &amp;  =  E\left(\exp\left( i\omega\cfrac{X}{\sqrt{n}} \right)\right) \\&amp; \overset{\text{(taylor)}}{=}  E\left( 1 +i\omega\cfrac{X}{\sqrt{n}} + \cfrac{1}{2} \left( i\omega\cfrac{X}{\sqrt{n}} \right)^2 +o\left(\cfrac{1}{n}\right)\right) \\&amp; =  1 + i\omega\cfrac{E(X)}{\sqrt{n}} - \cfrac{1}{2}  \omega^2\cfrac{E(X^2)}{n} + o\left(\cfrac{1}{n}\right) \\&amp; =  1 - \cfrac{\omega^2}{2n} + o\left(\cfrac{1}{n}\right)\end{aligned}\end{equation*}\]</span></p><blockquote><p>复习一个重要极限： <span class="math display">\[\lim_{n\rightarrow \infty} \left( 1 + \cfrac{a}{n} +o\left(\cfrac{1}{n}\right) \right)^n = \exp(a)\]</span></p></blockquote><p>现在将<span class="math inline">\(n\)</span>趋于<span class="math inline">\(\infty\)</span>，有 <span class="math display">\[\lim_{n\rightarrow\infty}\Phi_{\frac{Y}{\sqrt{n}}}(\omega)  =  \lim_{n\rightarrow\infty}\left(\Phi_X(\cfrac{\omega}{\sqrt{n}})\right) ^n=  \lim_{n\rightarrow\infty} \left(1 - \cfrac{\omega^2}{2n} +o\left(\cfrac{1}{n}\right)\right)^n=  \exp\left(-\cfrac{\omega^2}{2} \right)\]</span> 那么高斯分布的特征函数是怎样的呢？下面进一步分析。</p><p>对于均值为<span class="math inline">\(m\)</span>，方差为<span class="math inline">\(\sigma^2\)</span>的高斯分布<span class="math inline">\(X\)</span>，其概率密度函数为</p><p><span class="math display">\[f_X (x)= \cfrac{1}{\sqrt{2\pi} \sigma} \exp\left(-\cfrac{(x-m)^2}{2\sigma^2} \right)\]</span></p><p>于是，根据定义，<span class="math inline">\(X\)</span>的特征函数为<span class="math display">\[\begin{equation*}\begin{aligned}\Phi_X(\omega) &amp; =  \int_{-\infty}^{+\infty} \exp(i\omegax)f_X(x)\mathrm{d}x \\&amp; =  \int_{-\infty}^{+\infty} \cfrac{1}{\sqrt{2\pi} \sigma}\exp\left( -\cfrac{(x-m)^2}{2\sigma^2} + i\omega x \right) \mathrm{d}x\\&amp; =  \int_{-\infty}^{+\infty} \cfrac{1}{\sqrt{2\pi} \sigma}\exp\left( -\cfrac{1}{2\sigma ^2} \left(x - i\omega \sigma ^2 -m\right)^2 + im\omega - \cfrac{1}{2} \omega^2\sigma^2 \right)\mathrm{d}x \\&amp; =  \exp\left(im\omega - \cfrac{1}{2} \omega^2\sigma^2 \right)\cfrac{1}{\sqrt{2\pi} \sigma} \int_{-\infty}^{+\infty} \exp\left(-\cfrac{1}{2\sigma ^2} \left(x - i\omega \sigma ^2 - m\right)^2 \right)\mathrm{d}x \\&amp; =  \exp\left(im\omega - \cfrac{1}{2} \omega^2\sigma^2 \right)\end{aligned}\end{equation*}\]</span> 可以看出，高斯分布的特征函数仍是高斯的形状。令均值<span class="math inline">\(m=0\)</span>，方差<span class="math inline">\(\sigma ^2=1\)</span>，就得到<span class="math inline">\(\Phi_X(\omega) = \exp\left( -\cfrac{\omega^2}{2}\right)\)</span>。因此，刚才得到的<span class="math inline">\(\lim\Phi_Y\)</span>是标标准准的高斯分布的特征函数。至此，中心极限定理就证明出来了。</p><p>进一步地，我们看看大数定律。<strong>大数定律</strong>表述为</p><blockquote><p>有<span class="math inline">\(n\)</span>个独立同分布的随机变量<span class="math inline">\(X_1, X_2, \cdots,X_n\)</span>，假定他们均值都是<span class="math inline">\(E(X_k) =m\)</span>，那么当<span class="math inline">\(n\)</span>趋于<span class="math inline">\(\infty\)</span>时，这些随机变量之和与<span class="math inline">\(n\)</span>的比值趋于一个确定的值，这个值就是均值<span class="math inline">\(m\)</span>。即 <span class="math display">\[\lim_{n\rightarrow \infty} \cfrac{X_1 + X_2 + \cdots +X_n}{n} = m\]</span></p></blockquote><p>这个定律的验证与中心极限定理类似，不过由于分母是<span class="math inline">\(n\)</span>，后续的泰勒展开就只需要展开到一阶即可<span class="math display">\[\begin{equation*}\begin{aligned}\Phi_X(\cfrac{\omega}{n}) &amp; =  E\left(\exp\left( i\omega\cfrac{X}{n} \right)\right) \\&amp; \overset{\text{(taylor)}}{=}  E\left( 1 + i\omega\cfrac{X}{n} +o\left(\cfrac{1}{n}\right)\right) \\&amp; =  1 + i\omega\cfrac{E(X)}{n} + o\left(\cfrac{1}{n}\right) \\&amp; =  1 + \cfrac{i\omega m}{n} + o\left(\cfrac{1}{n}\right)\end{aligned}\end{equation*}\]</span> 进而 <span class="math display">\[\begin{equation*}\begin{aligned}\lim_{n\rightarrow\infty} \Phi_{\frac{Y}{n}}(\omega) &amp;=  \lim_{n\rightarrow\infty} \left(\Phi_X(\cfrac{\omega}{n})\right) ^n\\&amp; =  \lim_{n\rightarrow\infty} \left(1 + \cfrac{i\omega m}{n} +o\left(\cfrac{1}{n}\right)\right)^n \\&amp; =  \exp\left(i\omega m \right) \\&amp; =  \Phi_m(\omega)\end{aligned}\end{equation*}\]</span> 得到的是常函数m的特征函数，至此，大数定律就证明结束了。</p><h2 id="随机扩散random-diffusion模型">随机扩散(RandomDiffusion)模型</h2><p>为简化计算，考虑一维情况。现有一维随机扩散模型，用<span class="math inline">\(f(x,t)\)</span>表示在<span class="math inline">\(t\)</span>时刻，<span class="math inline">\(x\)</span>处粒子出现的概率密度。初始化条件为<span class="math inline">\(f(0,0)=1\)</span>，求<span class="math inline">\(f(x,t)\)</span>的一般表达式。</p><p>首先建立模型，用<span class="math inline">\(\rho(y)\)</span>表示在<span class="math inline">\(t=\tau\)</span>时位置<span class="math inline">\(y\)</span>处的粒子出现的概率密度，即<span class="math inline">\(\rho(y) = f(y,\tau)\)</span>，显然，<span class="math inline">\(\rho(y)\geq0,\ \int_{-\infty}^{+\infty}\rho(y)\mathrm{d}y = 1\)</span>。自然地，还可以有这样两个假设：</p><ol type="1"><li><span class="math inline">\(\rho(-y) = \rho(y)\)</span></li><li><span class="math inline">\(\int_{-\infty}^{+\infty}y\rho(y)\mathrm{d}y = 0\)</span></li></ol><p>于是，不难理解， <span class="math display">\[f(x,t+\tau) = \int_{-\infty}^{+\infty} f(x-y, t)\rho(y)\mathrm{d}y\]</span> 方程左右的<span class="math inline">\(f\)</span>在<span class="math inline">\((x,t)\)</span>处分别对<span class="math inline">\(x,\ t\)</span>展开，于是 <span class="math display">\[f(x,t) + \cfrac{\partial{f}}{\partial{t}} \tau =\int_{-\infty}^{+\infty} \left( f(x,t) -\cfrac{\partial{f}}{\partial{x}} y +\cfrac{1}{2}\cfrac{\partial^2{f}}{\partial{x^2}} y^2 \right)\rho(y)\mathrm{d}y\]</span> 带入上面条件，积分化简得 <span class="math display">\[\cfrac{\partial{f}}{\partial{t}} \tau = \cfrac{1}{2}\cfrac{\partial^2{f}}{\partial{x^2}}\int_{-\infty}^{+\infty}y^2\rho(y)\mathrm{d}y\]</span> 令 <span class="math display">\[c = \cfrac{1}{2\tau}\int_{-\infty}^{+\infty}y^2\rho(y)\mathrm{d}y\]</span> 上面方程则写作 <span class="math display">\[\cfrac{\partial{f}}{\partial{t}} = c\cfrac{\partial^2{f}}{\partial{x^2}}\]</span> 这个偏微分方程被称为<strong>扩散方程</strong>(diffusionequation)，其解（解法略，很常见的一类微分方程）为 <span class="math display">\[f(x,t) = \cfrac{1}{\sqrt{2\pi ct}} \exp(-\cfrac{x^2}{2ct})\]</span> 回到模型，可以看出，对于任一时间<span class="math inline">\(t\)</span>，粒子在全空间（模型假设是一维空间，无伤大雅）上密度是标标准准的高斯分布。</p><h2 id="最大熵maximum-entropy">最大熵(Maximum Entropy)</h2><p>对于随机过程<span class="math inline">\(X\)</span>，其概率密度分布函数为<span class="math inline">\(f_X(x)\)</span>，定义<span class="math inline">\(X\)</span>的熵函数<span class="math inline">\(H(X)\)</span>：</p><blockquote><p><span class="math display">\[H(X) = -\int_{-\infty}^{+\infty} f_X(x) \log f_X(x) \mathrm{d}x\]</span></p></blockquote><p>熵<span class="math inline">\(H(X)\)</span>反映的是随机过程<span class="math inline">\(X\)</span>的“无序度”，通俗地说，就是这个随机过程究竟有多“随机”。</p><p>现在我们考察，定义在<span class="math inline">\((-\infty,+\infty)\)</span>上的，确定一阶矩<span class="math inline">\(E(X)=\mu\)</span>，二阶矩<span class="math inline">\(E(X^2) = \sigma^2\)</span>的随机过程<span class="math inline">\(X\)</span>，要满足怎样的分布才能让自己是最“随机”的，即熵最大。</p><p><span class="math inline">\(X\)</span>的概率密度函数显然满足 <span class="math display">\[\int_{-\infty}^{+\infty}f_X(x)\mathrm{d}x - 1 = 0 \\\int_{-\infty}^{+\infty}xf_X(x)\mathrm{d}x - \mu  = 0 \\\int_{-\infty}^{+\infty}x^2f_X(x)\mathrm{d}x - \sigma^2 =0 \\\]</span> 将这些等式视为约束条件，构建拉格朗日函数 <span class="math display">\[\begin{equation*}\begin{aligned}\mathscr{L}(f_X(x)) = &amp; -\int_{-\infty}^{+\infty} f_X(x) \log f_X(x)\mathrm{d}x \\&amp; + \lambda_1\left(\int_{-\infty}^{+\infty}f_X(x)\mathrm{d}x -1\right) \\&amp; + \lambda_2\left(\int_{-\infty}^{+\infty}xf_X(x)\mathrm{d}x -\mu\right) \\&amp; + \lambda_3\left(\int_{-\infty}^{+\infty}x^2f_X(x)\mathrm{d}x -\sigma^2\right)\end{aligned}\end{equation*}\]</span> 现在要求得一个<span class="math inline">\(f_X\)</span>，使得<span class="math inline">\(\mathscr{L}\)</span>取极大值。注意，不同于普通的拉格朗日乘子法，这里待求得是一个函数<span class="math inline">\(f\)</span>而非自变量<span class="math inline">\(x\)</span>，普通得求导显然不可用，那么要如何做到呢？这里我们利用泛函分析里一个重要工具：变分法(funtionalvariational method)。</p><p>我们假定待求<span class="math inline">\(f\)</span>的最优解是<span class="math inline">\(f_0\)</span>，并且构造一元函数</p><p><span class="math display">\[G(t) = \mathscr{L}(f_0 + tg)\]</span></p><p>其中<span class="math inline">\(g\)</span>是与<span class="math inline">\(f\)</span>自变量一致的任意函数。由于<span class="math inline">\(f_0\)</span>是待求<span class="math inline">\(f\)</span>的最优解，有 <span class="math display">\[G(0) = \mathscr{L}(f_0) \geq \mathscr{L}(f_0 + tg) = G(t)\]</span></p><p>即<span class="math inline">\(G(0)\)</span>是<span class="math inline">\(G(t)\)</span>的最大值，故有</p><p><span class="math display">\[\left.\cfrac{\partial}{\partial{t}}G(t)\right|_{t=0} = 0\]</span></p><p>代入<span class="math inline">\(G(t) = \mathscr{L}(f_0 +tg)\)</span>得</p><p><span class="math display">\[\begin{equation*}\begin{aligned}\left.\cfrac{\partial}{\partial{t}}G(t)\right|_{t=0} =&amp;  \cfrac{\partial}{\partial{t}}\left(-\int_{-\infty}^{+\infty}(f+tg) \log (f+tg) \mathrm{d}x \right.\\&amp; + \left.\lambda_1\left(\int_{-\infty}^{+\infty}(f+tg)\mathrm{d}x -1\right) \right.\\&amp; + \left.\lambda_2\left(\int_{-\infty}^{+\infty}x(f+tg)\mathrm{d}x- \mu\right) \right.\\&amp; +\left.\left.\lambda_3\left(\int_{-\infty}^{+\infty}x^2(f+tg)\mathrm{d}x- \sigma^2\right) \right)\right|_{t=0} \\= &amp;  \int_{-\infty}^{+\infty} g\left( -\log{f} + (\lambda_1 - 1) +\lambda_2x + \lambda_3x^2 \right) \mathrm{d}x\\= &amp; 0\end{aligned}\end{equation*}\]</span></p><p>由于<span class="math inline">\(g\)</span>是任意的函数，因此被积函数中，必然有<span class="math display">\[-\log{f} + (\lambda_1 - 1) + \lambda_2x + \lambda_3x^2 \equiv 0\]</span> 于是 <span class="math display">\[f = f_X(x) = \exp\left( \lambda_3 x^2 + \lambda_2 x + \lambda_1 - 1\right)\]</span> 这是标标准准的高斯概率密度函数，因此随机过程<span class="math inline">\(X\)</span>是高斯过程时，其熵最大。</p><p>实际上，<span class="math inline">\(\lambda_1,\lambda_2,\lambda_3\)</span>显然是可以解的，虽然过程有点复杂，但结果确确实实是<span class="math display">\[f_X(x) = \cfrac{1}{\sqrt{2\pi}\sigma}\exp\left(-\cfrac{(x-\mu)^2}{2\sigma^2} \right)\]</span></p><blockquote><p>上面考虑的是双边无界条件。实际上，如果我们考虑单边无解或者双边有界情况的话，情况会有所不同。</p><ol type="1"><li><p><span class="math inline">\(x\in[0,+\infty)\)</span>，此时只需要约束一阶矩<span class="math inline">\(\int_{-\infty}^{+\infty}xf_X(x)\mathrm{d}x - \mu =0\)</span>，最大熵的<span class="math inline">\(f\)</span>为指数分布：<span class="math display">\[f_X(x) = \lambda \exp\left( -\lambda x \right) I_{[0,+\infty)}(x)\]</span></p></li><li><p><span class="math inline">\(x\in[a,b]\)</span>，此时不需要对矩有所约束，最大熵的<span class="math inline">\(f\)</span>为均匀分布： <span class="math display">\[f_X(x) = \cfrac{1}{b-a}\]</span></p></li></ol></blockquote>]]></content>
      
      
      <categories>
          
          <category> 学习笔记：随机过程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数学 </tag>
            
            <tag> 随机过程 </tag>
            
            <tag> 高斯过程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>随机过程笔记：宽平稳过程(1)</title>
      <link href="/2022/06/05/%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B2%E5%AE%BD%E5%B9%B3%E7%A8%B3%E8%BF%87%E7%A8%8B1/"/>
      <url>/2022/06/05/%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B2%E5%AE%BD%E5%B9%B3%E7%A8%B3%E8%BF%87%E7%A8%8B1/</url>
      
        <content type="html"><![CDATA[<p>平稳是随机过程中一个非常重要的概念，而宽平稳则属于其中一种类型。宽平稳过程具有良好的性质，本文首先介绍了其定义，然后研究了宽平稳过程在时域中的性质。本文属于随机过程笔记，根据清华大学电子工程系张颢副研究员的随机过程线上课程笔记整理而成，<a href="https://www.bilibili.com/video/BV1V44y1z7yi?share_source=copy_web">这是课程链接</a>。</p><span id="more"></span><h1 id="宽平稳过程的概念">宽平稳过程的概念</h1><p>随机过程有中一个非常重要的概念：<strong>平稳</strong>(Stationary)。指随机过程的某一类统计性质随时间变化保持不变，具体是怎样的性质，就需要具体案例具体分析了。</p><p>现在介绍<strong>宽平稳过程</strong>(wide-sense stationary process,W.S.S.)这样一个案例。</p><p>定义：若随机过程<span class="math inline">\(\mathbb{X}(t)\)</span>满足：</p><ol type="1"><li><p>不同的时刻<span class="math inline">\(t\)</span>下，<span class="math inline">\(\mathbb{X}(t)\)</span>的均值保持不变，即 <span class="math display">\[E\left( \mathbb{X}(t) \right) =m(t) \equiv m\]</span></p></li><li><p>对于任意的平移时间<span class="math inline">\(D\)</span>，都有<span class="math display">\[R_{\mathbb{X}} (t+D,s+D) = R_{\mathbb{X}} (t,s)\]</span></p></li></ol><p>则称<span class="math inline">\(\mathbb{X}(t)\)</span>是宽平稳过程。</p><p>根据定义的第二条，宽平稳下的随机过程相关函数实际上可以退化成一元函数：<span class="math display">\[\begin{eqnarray}R_\mathbb{X}(t, s) &amp; = &amp; R_\mathbb{X}(t-s, s-s)\\&amp; = &amp; R_\mathbb{X}(t-s, 0)\\&amp; \overset{\Delta}{=} &amp; R_\mathbb{X}(\tau)\end{eqnarray}\]</span> 其中，<span class="math inline">\(\tau =t-s\)</span>，即函数值只于<span class="math inline">\(t,s\)</span>的间距有关，与它们的具体值无关。</p><p>下面我们看两个例子。</p><p><strong>调制信号 Modulated Signal</strong></p><p>设有一随机过程<span class="math inline">\(\mathbb{X}(t) =A(t)\cos\left( 2\pi f_0 t +\theta\right)\)</span>，其中<span class="math inline">\(A\)</span>是随机过程，<span class="math inline">\(\theta\)</span>满足均匀分布<span class="math inline">\(\theta \sim U(0,2\pi)\)</span>，并且<span class="math inline">\(A, \theta\)</span>独立。那么<span class="math inline">\(\mathbb{X}\)</span>宽平稳吗？</p><p>首先考察宽平稳定义的第一条， <span class="math display">\[\begin{eqnarray}E\left(\mathbb{X}(t)\right) &amp; = &amp; E\left(A(t)\right)E\left(\cos\left( 2\pi f_0 t +\theta\right)\right) \\&amp; = &amp; E\left(A(t)\right) \int_0^{2\pi} \cos\left( 2\pi f_0 t+\theta\right) \mathrm{d}\theta \\&amp; \equiv &amp; 0\end{eqnarray}\]</span> 第一条满足；现考察定义的第二条， <span class="math display">\[\begin{eqnarray}R_{\mathbb{X}} (t+D,s+D) &amp; = &amp;E\left(\mathbb{X}(t+D)\mathbb{X}(s+D)\right) \\&amp; = &amp; E\left(A(t+D)A(s+D)\right) \cdot E\left(\cos\left( 2\pif_0 (t+D) +\theta\right) \cos\left( 2\pi f_0 (s+D) +\theta\right)\right) \\&amp; = &amp; E\left(A(t+D)A(s+D)\right) \cdot\cfrac{1}{2}E\left(\cos\left( 2\pi f_0 (t-s)\right)\right) \\&amp; = &amp; E\left(A(t+D)A(s+D)\right) \cdot\cfrac{1}{2}E\left(\cos\left( 2\pi f_0 \tau \right)\right)\end{eqnarray}\]</span> 因此，若振幅调制<span class="math inline">\(A(t)\)</span>是宽平稳的，则整体<span class="math inline">\(\mathbb{X}(t)\)</span>是宽平稳的。</p><p><strong>随机电报信号 Random Telegraph Signal</strong></p><p>随机过程<span class="math inline">\(\mathbb{X}\)</span>于每一时间<span class="math inline">\(t\)</span>上<span class="math inline">\(\mathbb{X}(t)\)</span>都在<span class="math inline">\(\set{1,-1}\)</span>中任意取值，现考察其是否宽平稳。设在<span class="math inline">\(\left[ s,t \right]\)</span>时间段内，信号切变<span class="math inline">\(k\)</span>次的概率为 <span class="math display">\[\rho = \cfrac{(\lambda(t-s))^k}{k!}\exp(-\lambda(t-s))\]</span></p><blockquote><p>这实际上就是<strong>泊松分布</strong>(Poisson distribution)。另有<span class="math display">\[\sum_{k=0}^{\infty} \cfrac{(\lambda(t-s))^k}{k!} = \exp(\lambda(t-s))\]</span></p></blockquote><p>定义第一条，即一阶矩略了。</p><p>现计算<span class="math inline">\(E\left( \mathbb{X}(t) \mathbb{X(s)}\right)\)</span>，设<span class="math inline">\(P_1=P(\left[ s,t\right],\text{even})\)</span>是信号在两个时刻之间切变偶数次的概率，<span class="math inline">\(P_{-1}=P(\left[ s,t \right],\text{odd})\)</span>是信号在两个时刻之间切变奇数次的概率，则 <span class="math display">\[E\left( \mathbb{X}(t) \mathbb{X(s)} \right) = 1\cdot P_1 + (-1) \cdotP_{-1}\]</span> 显然，<span class="math inline">\(P_{-1} =1-P_1\)</span>，因此计算其中一个就行了。现计算 <span class="math display">\[P_1 = \sum_{k:\text{even}}\cfrac{(\lambda(t-s))^k}{k!}\exp(-\lambda(t-s))\]</span> 利用<span class="math inline">\(\sum_{k=0}^{\infty}\cfrac{(\lambda(t-s))^k}{k!} =\exp(\lambda(t-s))\)</span>这一关系，注意到，当<span class="math inline">\(\lambda\)</span>变为<span class="math inline">\(-\lambda\)</span>时，左边级数中，偶数项值不变，奇数项会变号，右边结果变为<span class="math inline">\(\exp(-\lambda(t-s))\)</span>，于是 <span class="math display">\[\begin{eqnarray}\sum_{k: \text{even}}^{\infty} \cfrac{(\lambda(t-s))^k}{k!} &amp; =&amp; \cfrac{1}{2} \left(\sum_{k=0}^{\infty}\cfrac{(\lambda(t-s))^k}{k!} + \sum_{k=0}^{\infty}\cfrac{(-\lambda(t-s))^k}{k!}\right) \\&amp; = &amp; \cfrac{1}{2} \left( \exp(\lambda(t-s)) +\exp(-\lambda(t-s)) \right)\end{eqnarray}\]</span> 故 <span class="math display">\[\begin{eqnarray}P_1 &amp; = &amp; \sum_{k:\text{even}}\cfrac{(\lambda(t-s))^k}{k!}\exp(-\lambda(t-s)) \\&amp; = &amp; \cfrac{1}{2} \left( \exp(\lambda(t-s)) +\exp(-\lambda(t-s)) \right) \exp(-\lambda(t-s)) \\&amp; = &amp; \cfrac{1}{2} \left( 1 + \exp(-2\lambda(t-s)) \right) \\ \\P_{-1} &amp; = &amp; \cfrac{1}{2} \left( 1 - \exp(-2\lambda(t-s))\right)\end{eqnarray}\]</span> 于是 <span class="math display">\[\begin{eqnarray}R_\mathbb{X} (t,s) &amp; = &amp; E\left( \mathbb{X}(t) \mathbb{X(s)}\right)\\&amp; = &amp; \exp(-2\lambda(t-s))\\&amp; = &amp; \exp(-2\lambda \tau))\end{eqnarray}\]</span></p><p>因此，随机过程<span class="math inline">\(\mathbb{X}\)</span>是宽平稳的。</p><h1 id="正定性">正定性</h1><p>一般情况下，相关函数有这样的性质：</p><ol type="1"><li>对称性：<span class="math inline">\(R_\mathbb{X}(t,s) =R_\mathbb{X}(s, t)\)</span></li><li>柯西不等式：<span class="math inline">\(\left| R_\mathbb{X}(t,s)\right| \leq \left(R_\mathbb{X}(t,t)R_\mathbb{X}(s,s)\right)^\frac{1}{2}\)</span></li></ol><p>对于宽平稳过程<span class="math inline">\(\mathbb{X}\)</span>，由于<span class="math inline">\(R_\mathbb{X}(s,t) = R_\mathbb{X}(\tau),\ \tau =t-s\)</span>，上面两条性质则以表述为：</p><ol type="1"><li>偶函数：<span class="math inline">\(R_\mathbb{X}(\tau) =R_\mathbb{X}(-\tau)\)</span></li><li><span class="math inline">\(\tau = 0\)</span>为极大值点：<span class="math inline">\(\left| R_\mathbb{X}(\tau) \right| \leqR_\mathbb{X}(0)\)</span></li></ol><p>除此之外，宽平稳过程的相关函数还有一个非常重要的性质，那就是<strong>正定性</strong>(positivedefinite)。首先介绍正定性的概念：</p><p>若函数<span class="math inline">\(f(x)\)</span>满足：</p><p><span class="math inline">\(\forall n, \forall x_1, x_2, \cdotsx_n\)</span>，构成矩阵 <span class="math display">\[A_{n\times n} = \left(f(x_i - x_j)\right)_{ij}\]</span> 且这样的<span class="math inline">\(A_{n\timesn}\)</span>是正定的。</p><p>则称函数<span class="math inline">\(f(x)\)</span>是正定的。</p><blockquote><p>矩阵正定有很多种表述，其中一种就是：</p><p>矩阵<span class="math inline">\(A\in \mathbb{R}^{n\times n} \geq0\Leftrightarrow \forall \alpha \in \mathbb{R}^n, \alpha ^\mathrm{T}A\alpha \geq 0\)</span></p></blockquote><p>下面证明宽平稳的相关函数是正定的：</p><p>对于宽平稳过程<span class="math inline">\(\mathbb{X}(t)\)</span>，按照定义给出的构造<span class="math inline">\(R_{n\times n} = \left(R_\mathbb{X}(\tau_i -\tau_j)\right)_{ij}\)</span>，任取向量<span class="math inline">\(\alpha\in\mathbb{R}^n, \alpha = (\alpha_1,\alpha_2, \cdots \alpha_n)^\mathrm{T}\)</span>，有</p><p><span class="math display">\[\begin{eqnarray}\alpha^\mathrm{T} R \alpha &amp; = &amp;\left(\begin{array}{}\alpha_1 &amp; \alpha_2 &amp; \cdots &amp;\alpha_n\end{array}\right)\left[\begin{array}{}R_\mathbb{X}(\tau_1-\tau_1) &amp; R_\mathbb{X}(\tau_1-\tau_2) &amp;\cdots &amp; R_\mathbb{X}(\tau_1-\tau_n) \\R_\mathbb{X}(\tau_2-\tau_1) &amp; R_\mathbb{X}(\tau_2-\tau_2) &amp;\cdots &amp; R_\mathbb{X}(\tau_2-\tau_n) \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\R_\mathbb{X}(\tau_n-\tau_1) &amp; R_\mathbb{X}(\tau_n-\tau_2) &amp;\cdots &amp; R_\mathbb{X}(\tau_n-\tau_n) \\\end{array}\right]\left(\begin{array}{}\alpha_1 \\ \alpha_2 \\ \vdots \\ \alpha_n\end{array}\right)\\&amp; = &amp; \sum_{i=1}^n \sum_{j=1}^n \alpha_i \alpha_jR_\mathbb{X}(\tau_i - \tau_j) \\&amp; = &amp; \sum_{i=1}^n \sum_{j=1}^n \alpha_i \alpha_j E\left(\mathbb{X}(\tau_i) \mathbb{X}(\tau_j) \right) \\&amp; = &amp;  E\left( \sum_{i=1}^n \sum_{j=1}^n \alpha_i \alpha_j\mathbb{X}(\tau_i) \mathbb{X}(\tau_j) \right) \\&amp; = &amp;  E\left( \left( \sum_{i=1}^n \alpha_i \mathbb{X}(\tau_i)\right)^2 \right) \\&amp; \geq &amp; 0\end{eqnarray}\]</span></p><p>即<span class="math inline">\(R\)</span>是正定的，因此宽平稳过程<span class="math inline">\(\mathbb{X}(t)\)</span>是正定的。</p><blockquote><p>这里的计算过程也可以用矩阵-向量语言来更简洁地表述： 令<span class="math inline">\(\mathbb{X} = (\mathbb{X}(\tau_1),\mathbb{X}(\tau_2), \cdots\mathbb{X}(\tau_n))^\mathrm{T}\)</span>，则<span class="math inline">\(R= \left(R_\mathbb{X}(\tau_i - \tau_j)\right)_{ij} =E(\mathbb{X}\mathbb{X}^\mathrm{T})\)</span>，进而 <span class="math display">\[\begin{eqnarray}\alpha^\mathrm{T} R \alpha &amp;=&amp; \alpha^\mathrm{T}E(\mathbb{X}\mathbb{X}^\mathrm{T}) \alpha \\&amp;=&amp; E\left(\alpha^\mathrm{T} \mathbb{X}\mathbb{X}^\mathrm{T}\alpha\right) \\&amp;=&amp; E\left((\alpha^\mathrm{T} \mathbb{X})^2 \right) \\&amp;\geq&amp; 0\end{eqnarray}\]</span> 这里的<span class="math inline">\(E(\mathbb{X}\mathbb{X}^\mathrm{T})\)</span>称作相关矩阵(correlationmatrix)。</p></blockquote><p>实际上，正定函数<span class="math inline">\(f(x)\)</span>本身就有非常良好的性质，如</p><ol type="1"><li><p><span class="math inline">\(f(0)\geq 0\)</span></p><blockquote><p>证明： 取<span class="math inline">\(n=1, \forallx_1\)</span>，按照定义给出的矩阵： <span class="math display">\[A_{1\times 1} = f(x_1 - x_1) = f(0)\]</span> 由定义可知，<span class="math inline">\(A\)</span>是正定的，此时即<span class="math inline">\(f(0)\geq0\)</span>，证毕。</p></blockquote></li><li><p><span class="math inline">\(\forall x, f(0)\geq f(x)\)</span></p><blockquote><p>证明： 取<span class="math inline">\(n=2, x_1=0, \forallx_2=x\)</span>，按照定义给出的矩阵： <span class="math display">\[A_{2\times 2}  =\left[\begin{array}{}f(0 - 0) &amp; f(0 - x) \\f(x - 0) &amp; f(x - x)\end{array}\right] = \left[\begin{array}{}f(0) &amp; f(-x) \\f(x) &amp; f(0)\end{array}\right]\]</span> 由定义可知，<span class="math inline">\(A\)</span>是正定的，因此有</p><ul><li><p><span class="math inline">\(A\)</span>是对称的，即<span class="math inline">\(f(-x_2) = f(x_2)\)</span>，即<span class="math inline">\(f\)</span>是偶函数；</p></li><li><p><span class="math inline">\(\det A \geq 0\)</span>，即<span class="math inline">\(\left(f(0)\right)^2 - \left(f(x)\right)^2 \geq0\)</span>，又根据上一条性质<span class="math inline">\(f(x)\geq0\)</span>，有<span class="math inline">\(f(0) \geq f(x)\)</span>，证毕。</p></li></ul></blockquote></li></ol><p>可以看出，对于宽平稳过程的相关函数，正定性这一性质实际上包含了上面说明的两条宽平稳过程相关函数的前两条性质。</p><p>实际上，正定性是宽平稳过程相关函数的特征性质(characteristicproperty)，也就是说它们是充分必要的关系。</p><p>不仅如此，由于正定性，宽平稳过程相关函数<span class="math inline">\(R_\mathbb{X}(\tau)\)</span>还有其他不平凡的性质，下面我们举几个例子。</p><h2 id="周期震荡">周期震荡</h2><p>前面说到，<span class="math inline">\(R_\mathbb{X}(0) \geq \left|R_\mathbb{X}(\tau) \right|\)</span>，其图像可以感性地表示为：</p><p><img src="/2022/06/05/%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B2%E5%AE%BD%E5%B9%B3%E7%A8%B3%E8%BF%87%E7%A8%8B1/2_1.png"></p><p>在这样地前提下，若<span class="math inline">\(\existsT\)</span>，满足<span class="math inline">\(R_\mathbb{X}(T) =R_\mathbb{X}(0)\)</span>，则一定有<span class="math inline">\(R_\mathbb{X}(\tau) =R_\mathbb{X}(\tau+T)\)</span>，即<span class="math inline">\(R_\mathbb{X}\)</span>一定是周期为<span class="math inline">\(T\)</span>的周期函数。</p><p><img src="/2022/06/05/%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B2%E5%AE%BD%E5%B9%B3%E7%A8%B3%E8%BF%87%E7%A8%8B1/2_2.png"></p><p>要证明这一结论，我们想到 <span class="math display">\[\begin{eqnarray}R_\mathbb{X}(\tau) - R_\mathbb{X}(\tau+T) &amp;=&amp; E\left(\mathbb{X}(0)\mathbb{X}(\tau) \right) - E\left(\mathbb{X}(0)\mathbb{X}(\tau + T) \right) \\&amp;=&amp; E\left( \mathbb{X}(0) \left( \mathbb{X}(\tau) -\mathbb{X}(\tau + T) \right)\right)\end{eqnarray}\]</span> 联系到柯西不等式， <span class="math display">\[\left| E\left( \mathbb{X}(0) \left( \mathbb{X}(\tau) - \mathbb{X}(\tau +T) \right)\right)\right| \leq\left(E\left( \mathbb{X}(0) ^2\right) E\left( \left(\mathbb{X}(\tau) -\mathbb{X}(\tau + T)\right)^2 \right)\right)^\frac{1}{2}\]</span> 如果不等式右边可以证明为<span class="math inline">\(0\)</span>，那么该命题便成立了。按照这样的思路，要证明上面的结论，可以先证明这样的结论：</p><ul><li>若<span class="math inline">\(\exists T\)</span>，满足<span class="math inline">\(R_\mathbb{X}(T) =R_\mathbb{X}(0)\)</span>，则<span class="math inline">\(E\left(\left|\mathbb{X}(\tau) - \mathbb{X}(\tau + T)\right|^2\right)\)</span>。实际上，这一结论称均方周期性。</li></ul><p>进而根据柯西不等式得到我们所要的结论。</p><p>证明： <span class="math display">\[\begin{eqnarray}E\left( \left|\mathbb{X}(\tau) - \mathbb{X}(\tau + T)\right|^2 \right)&amp;=&amp; E\left( \mathbb{X}(\tau)^2 \right) - 2E\left(\mathbb{X}(\tau) \mathbb{X}(\tau + T) \right) + E\left( \mathbb{X}(\tau+ T)^2 \right) \\&amp;=&amp; E\left( R_\mathbb{X}(0) \right) - 2E\left( R_\mathbb{X}(T)\right) + E\left( R_\mathbb{X}(0) \right) \\&amp;=&amp;  2\left( R_\mathbb{X}(0) -  R_\mathbb{X}(T) \right) \\&amp;=&amp; 0\end{eqnarray}\]</span> 故有 <span class="math display">\[\begin{eqnarray}\left| R_\mathbb{X}(\tau) - R_\mathbb{X}(\tau+T) \right|&amp;=&amp; \left| E\left( \mathbb{X}(0) \left( \mathbb{X}(\tau) -\mathbb{X}(\tau + T) \right)\right) \right| \\&amp;\leq&amp; \left|E\left( \mathbb{X}(0) ^2\right) E\left(\left(\mathbb{X}(\tau) - \mathbb{X}(\tau + T)\right)^2\right)\right|^\frac{1}{2} \\&amp;=&amp; 0\end{eqnarray}\]</span> 因此，<span class="math inline">\(R_\mathbb{X}(\tau + T) =R_\mathbb{X}(\tau)\)</span>，证毕。</p><h2 id="bochner定理">Bochner定理</h2><p>仔细思考上面一节的内容，可以发现是一个“局部性质导出全局性质”的过程。本节继续介绍另一种同样是“局部性质导出全局性质”的过程。</p><p>先思考是否存在这样一种矩形窗宽平稳相关函数： <span class="math display">\[R_{\mathbb{X}}(\tau) =\left\{\begin{eqnarray}a &amp;&amp; ,\left| \tau \right| &lt;\tau_0 \\0 &amp;&amp; ,\text{elsewhere}\end{eqnarray}\right.(a&gt;0)\]</span> <img src="/2022/06/05/%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B2%E5%AE%BD%E5%B9%B3%E7%A8%B3%E8%BF%87%E7%A8%8B1/2_3.png"></p><p>先给出这样命题：</p><blockquote><p><span class="math inline">\(R_{\mathbb{X}}(\tau)\)</span>是宽平稳过程的相关函数，若<span class="math inline">\(R_{\mathbb{X}}(\tau)\)</span>在<span class="math inline">\(\tau=0\)</span>处连续，则<span class="math inline">\(R_{\mathbb{X}}(\tau)\)</span>在<span class="math inline">\(\tau=t, \forall t\)</span>处连续。</p></blockquote><p>若上述命题成立，则显然不存在那样的矩形窗宽平稳相关函数。现在我们就来证明这个命题。</p><p>按照上一小节的经验，我们同样把证明过程分解为两部分：</p><blockquote><ol type="1"><li><p><strong>均方连续性</strong>：<span class="math inline">\(R_{\mathbb{X}}(\tau)\)</span>是宽平稳过程的相关函数，若<span class="math inline">\(R_{\mathbb{X}}(\tau)\)</span>在<span class="math inline">\(\tau=0\)</span>处连续，则有 <span class="math display">\[\lim_{\Delta\rightarrow0}E\left( \mathbb{X}(t+\Delta) - \mathbb{X}(t)\right)^2 = 0\]</span></p></li><li><p>若一宽平稳随机过程<span class="math inline">\(\mathbb{X}(t)\)</span>满足上述均方连续性，则其相关函数<span class="math inline">\(R_{\mathbb{X}}(\tau)\)</span>在<span class="math inline">\(\tau=t, \forall t\)</span>处连续。</p></li></ol></blockquote><p>证明：</p><ol type="1"><li><span class="math display">\[E\left( \mathbb{X}(t+\Delta) - \mathbb{X}(t) \right)^2 =2R_{\mathbb{X}}(0) - 2R_{\mathbb{X}}(\Delta)\]</span> 由于<span class="math inline">\(R_{\mathbb{X}}(\tau)\)</span>在<span class="math inline">\(\tau =0\)</span>处连续，故<span class="math inline">\(\lim_{\Delta \rightarrow 0}\)</span></li></ol>]]></content>
      
      
      <categories>
          
          <category> 学习笔记：随机过程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数学 </tag>
            
            <tag> 随机过程 </tag>
            
            <tag> 宽平稳过程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>随机过程笔记：导论</title>
      <link href="/2022/06/01/%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B1%E5%AF%BC%E8%AE%BA/"/>
      <url>/2022/06/01/%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B1%E5%AF%BC%E8%AE%BA/</url>
      
        <content type="html"><![CDATA[<p>随机过程着眼于随机变量之间的相互关联，本文作为随机过程课程的导论部分，简单概述了随机变量之间“关联”的意义，引入了随机过程的定义，同时引入了相关函数这一概念。相关函数是研究随机过程的一个有力工具，对我们深入认识随机过程有“管中窥豹”的作用。本文属于随机过程笔记，根据清华大学电子工程系张颢副研究员的随机过程线上课程笔记整理而成，<a href="https://www.bilibili.com/video/BV1V44y1z7yi?share_source=copy_web">这是课程链接</a>。</p><span id="more"></span><h1 id="随机变量"><strong>随机变量</strong></h1><p>随机过程着眼于随机变量之间的相互关联。</p><p><span class="math inline">\(X,Y\)</span>是随机变量（后均称<span class="math inline">\(r.v.\)</span>）</p><p>它们的联合概率密度函数是 <span class="math display">\[f_{X,Y}(x,y) = \cfrac{\partial^2}{\partial x\partial y} F_{X,Y}(x,y)\]</span> 其中，<span class="math inline">\(F_{X,Y}(x,y)\)</span>是联合分布函数： <span class="math display">\[F_{X,Y}(x,y) = P(X\leq x, Y\leq y)\]</span></p><p>举例：</p><blockquote><ol type="1"><li><p><span class="math display">\[  \begin{equation}  f_{X,Y} (x,y) = \left\{  \begin{aligned}  \cfrac{1}{4}, &amp;&amp; \lvert x \rvert \leq 1, \lvert y \rvert \leq1 \\  0, &amp;&amp; \mathrm{elsewhere}  \end{aligned}  \right.  \end{equation}  \]</span></p><p><img src="/2022/06/01/%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B1%E5%AF%BC%E8%AE%BA/1_1.png"></p><p>此时，随机变量<span class="math inline">\(X,Y\)</span><strong>独立</strong>(independent)：其中一个随机变量的变化不导致另一个随机变量统计性质的变化。</p></li><li><p><span class="math display">\[\begin{equation}f_{X,Y} (x,y) = \left\{\begin{aligned}\cfrac{1}{\pi}, &amp;&amp; x^2 + y^2 \leq 1 \\0, &amp;&amp; \mathrm{elsewhere}\end{aligned}\right.\end{equation}\]</span></p><p><img src="/2022/06/01/%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B1%E5%AF%BC%E8%AE%BA/1_2.png"> 此时当随机变量<span class="math inline">\(X\)</span>改变时，<span class="math inline">\(Y\)</span>的统计性质（如方差)也发生相应的改变，随机变量<span class="math inline">\(X,Y\)</span>不再独立。</p></li><li><p><span class="math display">\[\begin{equation}f_{X,Y} (x,y) = \left\{\begin{aligned}\cfrac{1}{\lvert \Omega \rvert}, &amp;&amp; (x,y) \in \Omega \\0, &amp;&amp; \mathrm{elsewhere}\end{aligned}\right.\end{equation}  \]</span></p></li></ol><p><img src="/2022/06/01/%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B1%E5%AF%BC%E8%AE%BA/1_3.png"> 此时可以看出，当随机变量<span class="math inline">\(X\)</span>改变时<span class="math inline">\(Y\)</span>的均值这一统计性质也发生相应的“线性变化”，随机变量<span class="math inline">\(X,Y\)</span>存在着某种“线性关系”。这一“线性关系”可以用相关系数表示，这里的相关，指的是<strong>线性相关</strong>(linearcorrelation)。</p></blockquote><p>上面例3中的线性相关，可以用<strong>均方误差</strong>(mean squareerror)来表示： <span class="math display">\[E\left(\left( Y-\alpha X \right)^2\right)\]</span> 其反映了“纺锤”的“宽度”，<span class="math inline">\(\alpha\)</span>代表的是“斜率”，用图例3中的虚线表示：<span class="math display">\[\min_\alpha E\left( Y-\alpha X \right)^2 \Rightarrow \alpha_{\mathrm{optimal}} = \cfrac{E(XY)}{E(X^2)}\]</span></p><blockquote><p>有些地方的相关定义为<span class="math inline">\(E\left((X-E(X))(Y-E(Y))\right)\)</span>，实际上，经过一通计算，这个定义等于<span class="math inline">\(E(XY) - E(X)E(Y)\)</span>，这与<span class="math inline">\(E(XY)\)</span>相差一个常数，不需要太在意。因此这两种定义在本课程中不加以区分。</p></blockquote><p>上式中，我们一般更关注的是<span class="math inline">\(E(XY)\)</span>这一项，其可以称为<strong>相关</strong>(correlation)。而两个随机变量<strong>不相关</strong>(uncorrelated)指的是<span class="math inline">\(E(XY)=EXEY(=0)\)</span>。注意：不相关并不意味着独立，实际上，两变量独立的要求更为苛刻，它是不相关的充分条件，即独立<span class="math inline">\(\Rightarrow\)</span>不相关。举例：</p><blockquote><p><span class="math inline">\(\theta\)</span>服从在<span class="math inline">\(\left( 0,2\pi \right)\)</span>上的均匀分布： <span class="math display">\[\theta \sim U(0,2\pi)\]</span> 且有随机变量： <span class="math display">\[X=\cos{\theta}, \\Y=\sin{\theta}\]</span> 显然二者并不独立，但是 <span class="math display">\[\begin{eqnarray}E(X) &amp; = &amp; \int_{-\infty}^{\infty} \cos{\theta}f_\theta(\theta)\mathrm{d}\theta = \int_{0}^{2\pi} \cos{\theta}\cfrac{1}{2\pi}\mathrm{d}\theta = 0 \\E(Y) &amp; = &amp; \int_{-\infty}^{\infty} \sin{\theta}f_\theta(\theta)\mathrm{d}\theta = \int_{0}^{2\pi} \sin{\theta}\cfrac{1}{2\pi}\mathrm{d}\theta = 0 \\\\E(XY) &amp; = &amp; \int_{-\infty}^{\infty} \cos{\theta} \sin{\theta}f_\theta(\theta)\mathrm{d}\theta = 0\end{eqnarray}\]</span> 即 <span class="math display">\[E(XY)=E(X)E(Y)=0\]</span> 此时，随机变量<span class="math inline">\(X,Y\)</span>不相关。</p></blockquote><h1 id="随机变量的几何观点"><strong>随机变量的几何观点</strong></h1><p>实际上，可以将随机变量<span class="math inline">\(X,Y\)</span>的相关<span class="math inline">\(E(XY)\)</span>理解为某种<strong>内积</strong>(innerproduct)。关于内积，需要回顾一下：</p><blockquote><p>内积是一个二元操作<span class="math inline">\(\langle x,y \rangle : H\times H \rightarrow \mathbb{R}\)</span>，其满足以下三个条件：</p><ol type="1"><li><p>对称性：<span class="math inline">\(\langle x,y \rangle = \langley,x \rangle\)</span></p></li><li><p>非负性：<span class="math inline">\(\langle x,x \rangle \geq0\)</span>，且<span class="math inline">\(\langle x,x \rangle = 0\Leftrightarrow x=0\)</span></p></li><li><p><strong>双线性</strong>(bilinear)： <span class="math display">\[\langle x,\alpha y + \beta z \rangle = \alpha \langle x,y \rangle +\beta \langle x,z \rangle,\\\langle \alpha x + \beta y, z \rangle = \alpha \langle x,z \rangle +\beta \langle y,z \rangle\]</span></p></li></ol></blockquote><p>而相关的定义是符合以上三个条件的。</p><p>几何上，内积对应的是角度： <span class="math display">\[\cos \angle(x,y) = \cfrac{\langle x,y \rangle}{\left( \langle x,x\rangle \langle y,y \rangle  \right)^\frac{1}{2}}\]</span> 而一个随机变量<span class="math inline">\(r.v.\)</span>实际上可以理解为是线性空间中的一个向量，于是也可以算随机变量之间的“夹角”：</p><p><img src="/2022/06/01/%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B1%E5%AF%BC%E8%AE%BA/1_4.png"></p><p><span class="math display">\[\begin{eqnarray}\left| \left| Y \right| \right| \cos\theta \cdot \cfrac{X}{\left| \left|X \right| \right|} &amp; = &amp; \alpha X \\\Rightarrow \alpha &amp; = &amp; \cfrac{\left| \left| Y \right|\right|}{\left| \left| X \right| \right|} \cos \theta \\&amp; = &amp; \cfrac{\left| \left| Y \right| \right|}{\left| \left| X\right| \right|} \cfrac{E(XY)}{\left( E(X^2)E(Y^2)\right)^\frac{1}{2}}\\&amp; = &amp; \cfrac{\left| \left| Y \right| \right|}{\left| \left| X\right| \right|} \cfrac{E(XY)}{\left| \left| X \right| \right| \left|\left| Y \right| \right|} \\&amp; = &amp; \cfrac{E(XY)}{E(X^2)}\end{eqnarray}\]</span></p><p>其中，<span class="math inline">\(\theta = \angle(X,Y),\ \cos \theta= \cfrac{E(XY)}{\left(EX^2EY^2\right)^\frac{1}{2}}\)</span>。既然相关能够理解为向量内积，其自然满足<strong>Cauchy-Schwarz不等式</strong>：<span class="math display">\[-1 \leq \cos \angle(X,Y) = \cfrac{E(XY)}{\left(EX^2EY^2\right)^\frac{1}{2}} \leq 1\]</span></p><blockquote><p>Cauchy-Schwarz不等式： <span class="math display">\[\left| \langle x,y \rangle \right| \leq \left( \langle x,x \rangle\langle y,y \rangle \right) ^{\frac{1}{2}}\]</span> 证明：</p><p>构造<span class="math inline">\(g(\lambda) = \langle \lambda x + y,\lambda x + y \rangle\)</span></p><p>根据对称性和双线性，有 <span class="math display">\[g(\lambda) = \lambda ^2 \langle x,x \rangle + 2\lambda\langle x,y\rangle + \langle y,y \rangle\]</span> 由于<span class="math inline">\(\langle x,x \rangle \geq0\)</span>，因此关于<span class="math inline">\(\lambda\)</span>的二次函数<span class="math inline">\(g(\lambda)\)</span>是开口向上的。又由于<span class="math inline">\(g(\lambda) = \langle \lambda x + y, \lambda x + y\rangle \geq 0\)</span>，可知其判别式是非正的，即 <span class="math display">\[\Delta = \left( 2\langle x,y \rangle \right) ^2 - 4\langle x,x\rangle\langle y,y \rangle \leq 0\]</span> 即 <span class="math display">\[\langle x,y \rangle ^2 \leq \langle x,x \rangle\langle y,y \rangle\]</span> 证毕。</p></blockquote><h1 id="相关函数">相关函数</h1><p>首先引入随机过程这一概念<span class="math inline">\(\mathbb{X}(t)\)</span>，这里的<span class="math inline">\(t\)</span>是一个标记，可以是时间，也可以是别的什么东西，为方便说明问题，以后若有需要都称为“时间”。对不同的<span class="math inline">\(t_i\)</span>，<span class="math inline">\(\mathbb{X}(t_i)\)</span>都是一个随机变量。简单来说，随机过程实际上就是一组随机变量。如无特别说明，本课程讨论的这个下标<span class="math inline">\(t\)</span>是一维的；<span class="math inline">\(t\)</span>二维时<span class="math inline">\(\mathbb{X}(t)\)</span>称作随机场(randomfield)。</p><p>定义<strong>(自)相关函数</strong>(auto correlation function)： <span class="math display">\[R_{\mathbb{X}} (t,s) = E(\mathbb{X}(t)\mathbb{X}(s))\]</span>其反映了随机过程在两个不同时间处的相关性。显然有这样的性质：</p><ol type="1"><li><p>相关函数是对称的 <span class="math display">\[R_{\mathbb{X}} (t,s) = R_{\mathbb{X}} (s,t)\]</span></p></li><li><p>Cauchy-Schwarz不等式 <span class="math display">\[\left| R_{\mathbb{X}} (t,s) \right| \leq \left( R_{\mathbb{X}} (t,t)R_{\mathbb{X}} (s,s) \right) ^ \frac{1}{2}\]</span></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 学习笔记：随机过程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数学 </tag>
            
            <tag> 随机过程 </tag>
            
            <tag> 相关函数 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
